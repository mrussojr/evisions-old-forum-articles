<html><head>
<link rel="stylesheet" href="../../css/core.css">
<link rel="stylesheet" href="../../css/core_responsive.css">
<link rel="stylesheet" href="../../css/custom.css">
<link rel="stylesheet" href="../../css/flags.css">
<link rel="stylesheet" href="../../css/forums.css">
<link rel="stylesheet" href="../../css/forums_responsive.css">
<link rel="stylesheet" href="../../css/framework.css">
<link rel="stylesheet" href="../../css/responsive.css"></head>
<body class="ipsApp ipsApp_front ipsJS_has ipsClearfix ipsApp_noTouch" data-controller="core.front.core.app" data-message="" data-pageapp="forums" data-pagelocation="front" data-pagemodule="forums" data-pagecontroller="topic" itemscope="" itemtype="http://schema.org/WebSite">
<main role="main" id="ipsLayout_body" class="ipsLayout_container">
<div id="ipsLayout_contentArea">
<div id="ipsLayout_contentWrapper">
<div id="ipsLayout_mainArea">
<div data-controller="core.front.core.commentFeed,forums.front.topic.view, core.front.core.ignoredComments" data-autopoll="" data-baseurl="" data-lastpage="" data-feedid="topic-787" class="cTopic ipsClear ipsSpacer_top">
<div id="elPostFeed" data-role="commentFeed" data-controller="core.front.core.moderation">
<form action="" method="post" data-ipspageaction="" data-role="moderationTools">
<article id="elComment_749" class="cPost ipsBox  ipsComment  ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone  ">
	

	<div class="cAuthorPane cAuthorPane_mobile ipsResponsive_showPhone ipsResponsive_block">
		<h3 class="ipsType_sectionHead cAuthorPane_author ipsResponsive_showPhone ipsResponsive_inlineBlock ipsType_break ipsType_blendLinks ipsTruncate ipsTruncate_line">
			
Jef
			<span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</span>
		</h3>
		<div class="cAuthorPane_photo">
			

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_10/J.png.c32f05b787e4d22d4db36edf24176d27.png" alt="Jef">
	</span>

		</div>
	</div>
	<aside class="ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone"><h3 class="ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break">
<strong>
Jef</strong> <span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</span>
</h3>
		
		<ul class="cAuthorPane_info ipsList_reset">
			
				<li class="ipsType_break">New Member</li>
			
			
				<li><span class="ipsPip"></span></li>
			

			<li class="cAuthorPane_photo">
				

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_10/J.png.c32f05b787e4d22d4db36edf24176d27.png" alt="Jef">
	</span>

			</li>
			<li>Members</li>
			
			
				<li>

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</li>
				<li class="ipsType_light">1 post</li>
				
				

			
		</ul></aside><div class="ipsColumn ipsColumn_fluid">
		

<div id="comment-749_wrap" data-controller="core.front.core.comment" data-commentapp="forums" data-commenttype="forums" data-commentid="749" data-quotedata='{"userid":18089,"username":"Jef","timestamp":1504200990,"contentapp":"forums","contenttype":"forums","contentid":362,"contentclass":"forums_Topic","contentcommentid":749}' class="ipsComment_content ipsType_medium  ipsFaded_withHover">
	

	<div class="ipsComment_meta ipsType_light">
		<div class="ipsPos_right ipsType_light ipsType_reset ipsFaded ipsFaded_more ipsType_blendLinks">
			<ul class="ipsList_inline ipsComment_tools">
				
					<li><a href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=reportComment&amp;comment=749" data-ipsdialog data-ipsdialog-remotesubmit data-ipsdialog-size="medium" data-ipsdialog-flashmessage="Thanks for your report." data-ipsdialog-title="Report post" data-action="reportComment" title="Report this content" class="ipsFaded ipsFaded_more"><span class="ipsResponsive_showPhone ipsResponsive_inline"><i class="fa fa-flag"></i></span><span class="ipsResponsive_hidePhone ipsResponsive_inline">Report post</span></a></li>
				
				
				
					<li><a class="ipsType_blendLinks" href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/" data-ipstooltip title="Share this post" data-ipsmenu data-ipsmenu-closeonclick="false" id="elSharePost_749" data-role="shareComment"><i class="fa fa-share-alt"></i></a></li>
				
				
			</ul>
		</div>

		<div class="ipsType_reset">
			<a href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=749" class="ipsType_blendLinks">Posted <time datetime="2017-08-31T17:36:30Z" title="08/31/2017 05:36  PM" data-short="1 yr">August 31, 2017</time></a>
			<span class="ipsResponsive_hidePhone">
				
				
			</span>
		</div>
	</div>

	


	<div class="cPost_contentWrap ipsPad">
		
		<div data-role="commentContent" class="ipsType_normal ipsType_richText ipsContained" data-controller="core.front.core.lightboxedImages">
			
<p>
	Hi,
</p>

<p>
	 
</p>

<p>
	I created a report schedule with an email task.  I'm trying to embed the content of the report in the email body.  The issue is the email is only showing the first row of data.  It needs to loop through the records to show the other rows.  How can we do this?
</p>

<p>
	 
</p>

<pre class="ipsCode prettyprint lang-html prettyprinted">
<span class="tag">&lt;table&gt;</span><span class="pln">
</span><span class="tag">&lt;thead&gt;&lt;tr&gt;</span><span class="pln">
</span><span class="tag">&lt;th&gt;</span><span class="pln">StudentNumber</span><span class="tag">&lt;/th&gt;</span><span class="pln">
</span><span class="tag">&lt;th&gt;</span><span class="pln">NameLast</span><span class="tag">&lt;/th&gt;</span><span class="pln">
</span><span class="tag">&lt;th&gt;</span><span class="pln">NameFirst</span><span class="tag">&lt;/th&gt;</span><span class="pln">
</span><span class="tag">&lt;th&gt;</span><span class="pln">Term</span><span class="tag">&lt;/th&gt;</span><span class="pln">
</span><span class="tag">&lt;th&gt;</span><span class="pln">CheckInDate</span><span class="tag">&lt;/th&gt;</span><span class="pln">
</span><span class="tag">&lt;th&gt;</span><span class="pln">ContractDateStart</span><span class="tag">&lt;/th&gt;</span><span class="pln">
</span><span class="tag">&lt;th&gt;</span><span class="pln">Old</span><span class="tag">&lt;/th&gt;</span><span class="pln">
</span><span class="tag">&lt;th&gt;</span><span class="pln">New</span><span class="tag">&lt;/th&gt;</span><span class="pln">
</span><span class="tag">&lt;th&gt;</span><span class="pln">LogDate</span><span class="tag">&lt;/th&gt;</span><span class="pln">
</span><span class="tag">&lt;th&gt;</span><span class="pln">ModifiedBy</span><span class="tag">&lt;/th&gt;</span><span class="pln">
</span><span class="tag">&lt;/tr&gt;&lt;/thead&gt;</span><span class="pln">
</span><span class="tag">&lt;tbody&gt;&lt;tr&gt;</span><span class="pln">
</span><span class="tag">&lt;td&gt;</span><span class="pln">%%{ArgosData.StudentNumber}%%</span><span class="tag">&lt;/td&gt;</span><span class="pln">
</span><span class="tag">&lt;td&gt;</span><span class="pln">%%{ArgosData.NameLast}%%</span><span class="tag">&lt;/td&gt;</span><span class="pln">
</span><span class="tag">&lt;td&gt;</span><span class="pln">%%{ArgosData.NameFirst}%%</span><span class="tag">&lt;/td&gt;</span><span class="pln">
</span><span class="tag">&lt;td&gt;</span><span class="pln">%%{ArgosData.Term}%%</span><span class="tag">&lt;/td&gt;</span><span class="pln">
</span><span class="tag">&lt;td&gt;</span><span class="pln">%%{ArgosData.CheckInDate}%%</span><span class="tag">&lt;/td&gt;</span><span class="pln">
</span><span class="tag">&lt;td&gt;</span><span class="pln">%%{ArgosData.ContractDateStart}%%</span><span class="tag">&lt;/td&gt;</span><span class="pln">
</span><span class="tag">&lt;td&gt;</span><span class="pln">%%{ArgosData.Old}%%</span><span class="tag">&lt;/td&gt;</span><span class="pln">
</span><span class="tag">&lt;td&gt;</span><span class="pln">%%{ArgosData.New}%%</span><span class="tag">&lt;/td&gt;</span><span class="pln">
</span><span class="tag">&lt;td&gt;</span><span class="pln">%%{ArgosData.LogDate}%%</span><span class="tag">&lt;/td&gt;</span><span class="pln">
</span><span class="tag">&lt;td&gt;</span><span class="pln">%%{ArgosData.ModifiedBy}%%</span><span class="tag">&lt;/td&gt;</span><span class="pln">
</span><span class="tag">&lt;/tr&gt;&lt;/tbody&gt;</span><span class="pln">
</span><span class="tag">&lt;/table&gt;</span></pre>

<p>
	 
</p>

<p>
	Any help is appreciated.
</p>


			
		</div>

		<div class="ipsItemControls">
			
				
					

	<div data-controller="core.front.core.reaction" class="ipsItemControls_right ipsClearfix ">	
		<div class="ipsReact ipsPos_right">
			
				
				<div class="ipsReact_blurb ipsHide" data-role="reactionBlurb">
					
				</div>
			
			
			
		</div>
	</div>

				
			
			<ul class="ipsComment_controls ipsClearfix ipsItemControls_left" data-role="commentControls">
				
					
					
					
				
				<li class="ipsHide" data-role="commentLoading">
					<span class="ipsLoading ipsLoading_tiny ipsLoading_noAnim"></span>
				</li>
			</ul>
		</div>

		
	</div>

	<div class="ipsMenu ipsMenu_wide ipsHide cPostShareMenu" id="elSharePost_749_menu">
		<div class="ipsPad">
			<h4 class="ipsType_sectionHead">Share this post</h4>
			<hr class="ipsHr">
			<h5 class="ipsType_normal ipsType_reset">Link to post</h5>
			
			<input type="text" value="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/" class="ipsField_fullWidth">
			

			
		</div>
	</div>
</div>
	</div>
</article><article id="elComment_750" class="cPost ipsBox  ipsComment  ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone  ">
	

	<div class="cAuthorPane cAuthorPane_mobile ipsResponsive_showPhone ipsResponsive_block">
		<h3 class="ipsType_sectionHead cAuthorPane_author ipsResponsive_showPhone ipsResponsive_inlineBlock ipsType_break ipsType_blendLinks ipsTruncate ipsTruncate_line">
			
Todd Hay
			<span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 16
	
		</span>
	
</span>
		</h3>
		<div class="cAuthorPane_photo">
			

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_01/grumpycat2.thumb.jpg.3b9d127d0f3685ca4a975f30e517a9ba.jpg" alt="Todd Hay">
	</span>

		</div>
	</div>
	<aside class="ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone"><h3 class="ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break">
<strong>
Todd Hay</strong> <span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 16
	
		</span>
	
</span>
</h3>
		
		<ul class="cAuthorPane_info ipsList_reset">
			
				<li class="ipsType_break">Advanced Member</li>
			
			
				<li><span class="ipsPip"></span><span class="ipsPip"></span><span class="ipsPip"></span></li>
			

			<li class="cAuthorPane_photo">
				

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_01/grumpycat2.thumb.jpg.3b9d127d0f3685ca4a975f30e517a9ba.jpg" alt="Todd Hay">
	</span>

			</li>
			<li>Members</li>
			
			
				<li>

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 16
	
		</span>
	
</li>
				<li class="ipsType_light">53 posts</li>
				
				

			
		</ul></aside><div class="ipsColumn ipsColumn_fluid">
		

<div id="comment-750_wrap" data-controller="core.front.core.comment" data-commentapp="forums" data-commenttype="forums" data-commentid="750" data-quotedata='{"userid":1146,"username":"Todd Hay","timestamp":1504222374,"contentapp":"forums","contenttype":"forums","contentid":362,"contentclass":"forums_Topic","contentcommentid":750}' class="ipsComment_content ipsType_medium  ipsFaded_withHover">
	

	<div class="ipsComment_meta ipsType_light">
		<div class="ipsPos_right ipsType_light ipsType_reset ipsFaded ipsFaded_more ipsType_blendLinks">
			<ul class="ipsList_inline ipsComment_tools">
				
					<li><a href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=reportComment&amp;comment=750" data-ipsdialog data-ipsdialog-remotesubmit data-ipsdialog-size="medium" data-ipsdialog-flashmessage="Thanks for your report." data-ipsdialog-title="Report post" data-action="reportComment" title="Report this content" class="ipsFaded ipsFaded_more"><span class="ipsResponsive_showPhone ipsResponsive_inline"><i class="fa fa-flag"></i></span><span class="ipsResponsive_hidePhone ipsResponsive_inline">Report post</span></a></li>
				
				
				
					<li><a class="ipsType_blendLinks" href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=750" data-ipstooltip title="Share this post" data-ipsmenu data-ipsmenu-closeonclick="false" id="elSharePost_750" data-role="shareComment"><i class="fa fa-share-alt"></i></a></li>
				
				
			</ul>
		</div>

		<div class="ipsType_reset">
			<a href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=750" class="ipsType_blendLinks">Posted <time datetime="2017-08-31T23:32:54Z" title="08/31/2017 11:32  PM" data-short="1 yr">August 31, 2017</time></a>
			<span class="ipsResponsive_hidePhone">
				
				
			</span>
		</div>
	</div>

	


	<div class="cPost_contentWrap ipsPad">
		
		<div data-role="commentContent" class="ipsType_normal ipsType_richText ipsContained" data-controller="core.front.core.lightboxedImages">
			
<p>
	According to this thread, there is feature request for multiple row processing...
</p>

<p>
	 
</p>
<iframe data-embedcontent="" frameborder="0" src="https://archive.evisions.com/forums/topic/234-multiple-record-output-in-body-of-scheduled-email/?do=embed&amp;comment=429&amp;embedComment=429&amp;embedDo=findComment#comment-429"></iframe>

<p>
	Todd Hay
</p>

<p>
	Worcester Polytechnic Institute | ITS
</p>


			
		</div>

		<div class="ipsItemControls">
			
				
					

	<div data-controller="core.front.core.reaction" class="ipsItemControls_right ipsClearfix ">	
		<div class="ipsReact ipsPos_right">
			
				
				<div class="ipsReact_blurb " data-role="reactionBlurb">
					
						

	
	<ul class="ipsReact_reactions">
	
		
			
			<li class="ipsReact_reactCount">
				
					<span data-ipstooltip title="Like">
				
						<span>
							<img src="//content.invisioncic.com/r269962/reactions/react_like.png" alt="Like">
						</span>
						<span>
							1
						</span>
				
					</span>
				
			</li>
		
	
	</ul>

<div class="ipsReact_overview ipsType_blendLinks">
	
	
</div>
					
				</div>
			
			
			
		</div>
	</div>

				
			
			<ul class="ipsComment_controls ipsClearfix ipsItemControls_left" data-role="commentControls">
				
					
					
					
				
				<li class="ipsHide" data-role="commentLoading">
					<span class="ipsLoading ipsLoading_tiny ipsLoading_noAnim"></span>
				</li>
			</ul>
		</div>

		
	</div>

	<div class="ipsMenu ipsMenu_wide ipsHide cPostShareMenu" id="elSharePost_750_menu">
		<div class="ipsPad">
			<h4 class="ipsType_sectionHead">Share this post</h4>
			<hr class="ipsHr">
			<h5 class="ipsType_normal ipsType_reset">Link to post</h5>
			
			<input type="text" value="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=750" class="ipsField_fullWidth">
			

			
		</div>
	</div>
</div>
	</div>
</article><article id="elComment_751" class="cPost ipsBox  ipsComment  ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone  ">
	

	<div class="cAuthorPane cAuthorPane_mobile ipsResponsive_showPhone ipsResponsive_block">
		<h3 class="ipsType_sectionHead cAuthorPane_author ipsResponsive_showPhone ipsResponsive_inlineBlock ipsType_break ipsType_blendLinks ipsTruncate ipsTruncate_line">
			
chamblin
			<span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 19
	
		</span>
	
</span>
		</h3>
		<div class="cAuthorPane_photo">
			

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2018_10/WIN_20180910_09_34_24_Pro_InPixio.thumb.jpg.0922146a514d08b8b8da75254902a88a.jpg" alt="chamblin">
	</span>

		</div>
	</div>
	<aside class="ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone"><h3 class="ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break">
<strong>
chamblin</strong> <span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 19
	
		</span>
	
</span>
</h3>
		
		<ul class="cAuthorPane_info ipsList_reset">
			
				<li class="ipsType_break">Advanced Member</li>
			
			
				<li><span class="ipsPip"></span><span class="ipsPip"></span><span class="ipsPip"></span></li>
			

			<li class="cAuthorPane_photo">
				

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2018_10/WIN_20180910_09_34_24_Pro_InPixio.thumb.jpg.0922146a514d08b8b8da75254902a88a.jpg" alt="chamblin">
	</span>

			</li>
			<li>Members</li>
			
			
				<li>

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 19
	
		</span>
	
</li>
				<li class="ipsType_light">64 posts</li>
				
				

			
		</ul></aside><div class="ipsColumn ipsColumn_fluid">
		

<div id="comment-751_wrap" data-controller="core.front.core.comment" data-commentapp="forums" data-commenttype="forums" data-commentid="751" data-quotedata='{"userid":3018,"username":"chamblin","timestamp":1504278221,"contentapp":"forums","contenttype":"forums","contentid":362,"contentclass":"forums_Topic","contentcommentid":751}' class="ipsComment_content ipsType_medium  ipsFaded_withHover">
	

	<div class="ipsComment_meta ipsType_light">
		<div class="ipsPos_right ipsType_light ipsType_reset ipsFaded ipsFaded_more ipsType_blendLinks">
			<ul class="ipsList_inline ipsComment_tools">
				
					<li><a href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=reportComment&amp;comment=751" data-ipsdialog data-ipsdialog-remotesubmit data-ipsdialog-size="medium" data-ipsdialog-flashmessage="Thanks for your report." data-ipsdialog-title="Report post" data-action="reportComment" title="Report this content" class="ipsFaded ipsFaded_more"><span class="ipsResponsive_showPhone ipsResponsive_inline"><i class="fa fa-flag"></i></span><span class="ipsResponsive_hidePhone ipsResponsive_inline">Report post</span></a></li>
				
				
				
					<li><a class="ipsType_blendLinks" href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=751" data-ipstooltip title="Share this post" data-ipsmenu data-ipsmenu-closeonclick="false" id="elSharePost_751" data-role="shareComment"><i class="fa fa-share-alt"></i></a></li>
				
				
			</ul>
		</div>

		<div class="ipsType_reset">
			<a href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=751" class="ipsType_blendLinks">Posted <time datetime="2017-09-01T15:03:41Z" title="09/01/2017 03:03  PM" data-short="1 yr">September 1, 2017</time></a>
			<span class="ipsResponsive_hidePhone">
				
					(edited)
				
				
			</span>
		</div>
	</div>

	


	<div class="cPost_contentWrap ipsPad">
		
		<div data-role="commentContent" class="ipsType_normal ipsType_richText ipsContained" data-controller="core.front.core.lightboxedImages">
			
<p>
	I had to actually jump through a few hoops to do this.  This is how we did it:
</p>

<p>
	I created a global temporary table (Oracle) and then had an independent variable with PL/SQL that would loop through the records, concatenate them (with line breaks... chr(10)||chr(13)) to itself in the same field in the same table.  This would create one big field in a temporary table with all of the data concatenated together with the line break characters at the end of each row.  It's possible to actually include your html table tags in with the concatenated data (I would think)... you'd only have to create the temp_table once in your project lifetime, as a global temp table will remain after use but will conveniently clear itself out when your done!  
</p>

<p>
	 
</p>

<p>
	First, create the table:
</p>

<p>
	-------------------------------------------------------------------------------------------------------------------------
</p>

<pre style="color:#000000;">
CREATE GLOBAL TEMPORARY TABLE GTT_TEMP_TABLE (
  StudentNumber     NUMBER,
  EmailMessage  LONG
)
ON COMMIT DELETE ROWS;</pre>

<p>
	 
</p>

<p>
	and your program loop in the variable would look something like this:
</p>

<p>
	---------------------------------------------------------------------------------------------------------------------------
</p>

<p>
	DECLARE<br>
	CURSOR GET_RECORDS IS
</p>

<p>
	<br>
	SELECT 
</p>

<p>
	StudentNumber, NameLast, NameFirst, Term, CheckInDate, ContractDateStart, Old, New, LogDate, ModifiedBy
</p>

<p>
	FROM TheTable;
</p>

<p>
	 
</p>

<p>
	TEMP_REC GET_RECORDS%ROWTYPE;
</p>

<p>
	BEGIN
</p>

<p>
	 
</p>

<p>
	DELETE FROM GTT_TEMP_TABLE;
</p>

<p>
	 
</p>

<p>
	OPEN GET_RECORDS;
</p>

<p>
	<br>
	LOOP
</p>

<p>
	<br>
	    FETCH GET_RECORDS INTO TEMP_REC;
</p>

<p>
	<br>
	    EXIT WHEN GET_RECORDS%NOTFOUND;
</p>

<p>
	 
</p>

<p>
	    INSERT INTO GTT_TEMP_TABLE VALUES<br>
	   ( StudentNumber,
</p>

<p>
	<span style="color:#000088;">     '&lt;td&gt;</span><span style="color:#000000;">'||</span>TEMP_REC.<span style="color:#000000;">StudentNumber||'</span><span style="color:#000088;">&lt;/td&gt;</span><span style="color:#000088;">&lt;td&gt;</span><span style="color:#000000;">'||</span>TEMP_REC.<span style="color:#000000;">NameLast||'</span><span style="color:#000088;">&lt;/td&gt;</span><span style="color:#000088;">&lt;td&gt;</span><span style="color:#000000;">'||</span>TEMP_REC.<span style="color:#000000;">NameFirst||<br>
	     '</span><span style="color:#000088;">&lt;/td&gt;</span><span style="color:#000088;">&lt;td&gt;</span><span style="color:#000000;">'||</span>TEMP_REC.<span style="color:#000000;">Term||'</span><span style="color:#000088;">&lt;/td&gt;</span><span style="color:#000088;">&lt;td&gt;</span><span style="color:#000000;">'||</span>TEMP_REC.<span style="color:#000000;">CheckInDate||'</span><span style="color:#000088;">&lt;/td&gt;</span><span style="color:#000088;">&lt;td&gt;</span><span style="color:#000000;">'||</span>TEMP_REC.<span style="color:#000000;">ContractDateStart||<br>
	     '</span><span style="color:#000088;">&lt;/td&gt;</span><span style="color:#000088;">&lt;td&gt;</span><span style="color:#000000;">'||</span>TEMP_REC.<span style="color:#000000;">Old||'</span><span style="color:#000088;">&lt;/td&gt;</span><span style="color:#000088;">&lt;td&gt;</span><span style="color:#000000;">'||</span>TEMP_REC.<span style="color:#000000;">New||'</span><span style="color:#000088;">&lt;/td&gt;</span><span style="color:#000088;">&lt;td&gt;</span><span style="color:#000000;">'||</span>TEMP_REC.<span style="color:#000000;">LogDate||<br>
	     '</span><span style="color:#000088;">&lt;td&gt;</span><span style="color:#000000;">'||</span>TEMP_REC.<span style="color:#000000;">ModifiedBy||'</span><span style="color:#000088;">&lt;/td&gt;'||chr(10)||chr(13)</span>
</p>

<p>
	);
</p>

<p>
	 
</p>

<p>
	END LOOP;<br>
	CLOSE GET_RECORDS;<br>
	COMMIT;<br>
	END;
</p>

<p>
	 
</p>

<p>
	and then your report query would look something like this:
</p>

<p>
	-------------------------------------------------------------------------------------------------------------------------------------------------------------------
</p>

<p>
	SELECT  EmailMessage
</p>

<p>
	FROM    GTT_TEMP_TABLE 
</p>

<p>
	 
</p>

<p>
	 
</p>

<p>
	and then your email body would look like:
</p>

<p>
	--------------------------------------------------------------------------------------------------------------------------------------------------------------------
</p>

<pre style="color:#272a34;">
<span style="color:#000088;">&lt;table&gt;</span><span style="color:#000000;">
</span><span style="color:#000088;">&lt;thead&gt;&lt;tr&gt;</span><span style="color:#000000;">
</span><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">StudentNumber</span><span style="color:#000088;">&lt;/th&gt;</span><span style="color:#000000;">
</span><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">NameLast</span><span style="color:#000088;">&lt;/th&gt;</span><span style="color:#000000;">
</span><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">NameFirst</span><span style="color:#000088;">&lt;/th&gt;</span><span style="color:#000000;">
</span><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">Term</span><span style="color:#000088;">&lt;/th&gt;</span><span style="color:#000000;">
</span><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">CheckInDate</span><span style="color:#000088;">&lt;/th&gt;</span><span style="color:#000000;">
</span><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">ContractDateStart</span><span style="color:#000088;">&lt;/th&gt;</span><span style="color:#000000;">
</span><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">Old</span><span style="color:#000088;">&lt;/th&gt;</span><span style="color:#000000;">
</span><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">New</span><span style="color:#000088;">&lt;/th&gt;</span><span style="color:#000000;">
</span><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">LogDate</span><span style="color:#000088;">&lt;/th&gt;</span><span style="color:#000000;">
</span><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">ModifiedBy</span><span style="color:#000088;">&lt;/th&gt;</span><span style="color:#000000;">
</span><span style="color:#000088;">&lt;/tr&gt;&lt;/thead&gt;</span><span style="color:#000000;">
</span><span style="color:#000088;">&lt;tbody&gt;&lt;tr&gt;</span><span style="color:#000000;">
</span><span style="color:#000000;">%%{ArgosData.EmailMessage}%%</span><span style="color:#000000;">
</span><span style="color:#000088;">&lt;/tr&gt;&lt;/tbody&gt;</span><span style="color:#000000;">
</span><span style="color:#000088;">&lt;/table&gt;</span></pre>

<p>
	 
</p>

<p>
	 
</p>

<p>
	 
</p>

<p>
	 
</p>


			
				

<span class="ipsType_reset ipsType_medium ipsType_light" data-excludequote>
	<strong>Edited <time datetime="2017-09-01T15:47:11Z" title="09/01/2017 03:47  PM" data-short="1 yr">September 1, 2017</time> by chamblin</strong>
	
	
</span>
			
		</div>

		<div class="ipsItemControls">
			
				
					

	<div data-controller="core.front.core.reaction" class="ipsItemControls_right ipsClearfix ">	
		<div class="ipsReact ipsPos_right">
			
				
				<div class="ipsReact_blurb " data-role="reactionBlurb">
					
						

	
	<ul class="ipsReact_reactions">
	
		
			
			<li class="ipsReact_reactCount">
				
					<span data-ipstooltip title="Like">
				
						<span>
							<img src="//content.invisioncic.com/r269962/reactions/react_like.png" alt="Like">
						</span>
						<span>
							1
						</span>
				
					</span>
				
			</li>
		
	
	</ul>

<div class="ipsReact_overview ipsType_blendLinks">
	
	
</div>
					
				</div>
			
			
			
		</div>
	</div>

				
			
			<ul class="ipsComment_controls ipsClearfix ipsItemControls_left" data-role="commentControls">
				
					
					
					
				
				<li class="ipsHide" data-role="commentLoading">
					<span class="ipsLoading ipsLoading_tiny ipsLoading_noAnim"></span>
				</li>
			</ul>
		</div>

		
	</div>

	<div class="ipsMenu ipsMenu_wide ipsHide cPostShareMenu" id="elSharePost_751_menu">
		<div class="ipsPad">
			<h4 class="ipsType_sectionHead">Share this post</h4>
			<hr class="ipsHr">
			<h5 class="ipsType_normal ipsType_reset">Link to post</h5>
			
			<input type="text" value="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=751" class="ipsField_fullWidth">
			

			
		</div>
	</div>
</div>
	</div>
</article><article id="elComment_752" class="cPost ipsBox  ipsComment  ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone  ">
	

	<div class="cAuthorPane cAuthorPane_mobile ipsResponsive_showPhone ipsResponsive_block">
		<h3 class="ipsType_sectionHead cAuthorPane_author ipsResponsive_showPhone ipsResponsive_inlineBlock ipsType_break ipsType_blendLinks ipsTruncate ipsTruncate_line">
			
chamblin
			<span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 19
	
		</span>
	
</span>
		</h3>
		<div class="cAuthorPane_photo">
			

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2018_10/WIN_20180910_09_34_24_Pro_InPixio.thumb.jpg.0922146a514d08b8b8da75254902a88a.jpg" alt="chamblin">
	</span>

		</div>
	</div>
	<aside class="ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone"><h3 class="ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break">
<strong>
chamblin</strong> <span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 19
	
		</span>
	
</span>
</h3>
		
		<ul class="cAuthorPane_info ipsList_reset">
			
				<li class="ipsType_break">Advanced Member</li>
			
			
				<li><span class="ipsPip"></span><span class="ipsPip"></span><span class="ipsPip"></span></li>
			

			<li class="cAuthorPane_photo">
				

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2018_10/WIN_20180910_09_34_24_Pro_InPixio.thumb.jpg.0922146a514d08b8b8da75254902a88a.jpg" alt="chamblin">
	</span>

			</li>
			<li>Members</li>
			
			
				<li>

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 19
	
		</span>
	
</li>
				<li class="ipsType_light">64 posts</li>
				
				

			
		</ul></aside><div class="ipsColumn ipsColumn_fluid">
		

<div id="comment-752_wrap" data-controller="core.front.core.comment" data-commentapp="forums" data-commenttype="forums" data-commentid="752" data-quotedata='{"userid":3018,"username":"chamblin","timestamp":1504280766,"contentapp":"forums","contenttype":"forums","contentid":362,"contentclass":"forums_Topic","contentcommentid":752}' class="ipsComment_content ipsType_medium  ipsFaded_withHover">
	

	<div class="ipsComment_meta ipsType_light">
		<div class="ipsPos_right ipsType_light ipsType_reset ipsFaded ipsFaded_more ipsType_blendLinks">
			<ul class="ipsList_inline ipsComment_tools">
				
					<li><a href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=reportComment&amp;comment=752" data-ipsdialog data-ipsdialog-remotesubmit data-ipsdialog-size="medium" data-ipsdialog-flashmessage="Thanks for your report." data-ipsdialog-title="Report post" data-action="reportComment" title="Report this content" class="ipsFaded ipsFaded_more"><span class="ipsResponsive_showPhone ipsResponsive_inline"><i class="fa fa-flag"></i></span><span class="ipsResponsive_hidePhone ipsResponsive_inline">Report post</span></a></li>
				
				
				
					<li><a class="ipsType_blendLinks" href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=752" data-ipstooltip title="Share this post" data-ipsmenu data-ipsmenu-closeonclick="false" id="elSharePost_752" data-role="shareComment"><i class="fa fa-share-alt"></i></a></li>
				
				
			</ul>
		</div>

		<div class="ipsType_reset">
			<a href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=752" class="ipsType_blendLinks">Posted <time datetime="2017-09-01T15:46:06Z" title="09/01/2017 03:46  PM" data-short="1 yr">September 1, 2017</time></a>
			<span class="ipsResponsive_hidePhone">
				
				
			</span>
		</div>
	</div>

	


	<div class="cPost_contentWrap ipsPad">
		
		<div data-role="commentContent" class="ipsType_normal ipsType_richText ipsContained" data-controller="core.front.core.lightboxedImages">
			<p>
	I had to edit my earlier post quite a bit (I hit Enter and it posted itself prematurely), so I'm sending a new reply to get your attention in case you read it while it was messy!
</p>

			
		</div>

		<div class="ipsItemControls">
			
				
					

	<div data-controller="core.front.core.reaction" class="ipsItemControls_right ipsClearfix ">	
		<div class="ipsReact ipsPos_right">
			
				
				<div class="ipsReact_blurb " data-role="reactionBlurb">
					
						

	
	<ul class="ipsReact_reactions">
	
		
			
			<li class="ipsReact_reactCount">
				
					<span data-ipstooltip title="Like">
				
						<span>
							<img src="//content.invisioncic.com/r269962/reactions/react_like.png" alt="Like">
						</span>
						<span>
							1
						</span>
				
					</span>
				
			</li>
		
	
	</ul>

<div class="ipsReact_overview ipsType_blendLinks">
	
	
</div>
					
				</div>
			
			
			
		</div>
	</div>

				
			
			<ul class="ipsComment_controls ipsClearfix ipsItemControls_left" data-role="commentControls">
				
					
					
					
				
				<li class="ipsHide" data-role="commentLoading">
					<span class="ipsLoading ipsLoading_tiny ipsLoading_noAnim"></span>
				</li>
			</ul>
		</div>

		
	</div>

	<div class="ipsMenu ipsMenu_wide ipsHide cPostShareMenu" id="elSharePost_752_menu">
		<div class="ipsPad">
			<h4 class="ipsType_sectionHead">Share this post</h4>
			<hr class="ipsHr">
			<h5 class="ipsType_normal ipsType_reset">Link to post</h5>
			
			<input type="text" value="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=752" class="ipsField_fullWidth">
			

			
		</div>
	</div>
</div>
	</div>
</article><article id="elComment_1636" class="cPost ipsBox  ipsComment  ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone  ">
	

	<div class="cAuthorPane cAuthorPane_mobile ipsResponsive_showPhone ipsResponsive_block">
		<h3 class="ipsType_sectionHead cAuthorPane_author ipsResponsive_showPhone ipsResponsive_inlineBlock ipsType_break ipsType_blendLinks ipsTruncate ipsTruncate_line">
			
Sajjan
			<span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</span>
		</h3>
		<div class="cAuthorPane_photo">
			

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2018_08/S_member_20320.png" alt="Sajjan">
	</span>

		</div>
	</div>
	<aside class="ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone"><h3 class="ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break">
<strong>
Sajjan</strong> <span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</span>
</h3>
		
		<ul class="cAuthorPane_info ipsList_reset">
			
				<li class="ipsType_break">New Member</li>
			
			
				<li><span class="ipsPip"></span></li>
			

			<li class="cAuthorPane_photo">
				

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2018_08/S_member_20320.png" alt="Sajjan">
	</span>

			</li>
			<li>Members</li>
			
			
				<li>

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</li>
				<li class="ipsType_light">3 posts</li>
				
				

			
		</ul></aside><div class="ipsColumn ipsColumn_fluid">
		

<div id="comment-1636_wrap" data-controller="core.front.core.comment" data-commentapp="forums" data-commenttype="forums" data-commentid="1636" data-quotedata='{"userid":20320,"username":"Sajjan","timestamp":1540327947,"contentapp":"forums","contenttype":"forums","contentid":362,"contentclass":"forums_Topic","contentcommentid":1636}' class="ipsComment_content ipsType_medium  ipsFaded_withHover">
	

	<div class="ipsComment_meta ipsType_light">
		<div class="ipsPos_right ipsType_light ipsType_reset ipsFaded ipsFaded_more ipsType_blendLinks">
			<ul class="ipsList_inline ipsComment_tools">
				
					<li><a href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=reportComment&amp;comment=1636" data-ipsdialog data-ipsdialog-remotesubmit data-ipsdialog-size="medium" data-ipsdialog-flashmessage="Thanks for your report." data-ipsdialog-title="Report post" data-action="reportComment" title="Report this content" class="ipsFaded ipsFaded_more"><span class="ipsResponsive_showPhone ipsResponsive_inline"><i class="fa fa-flag"></i></span><span class="ipsResponsive_hidePhone ipsResponsive_inline">Report post</span></a></li>
				
				
				
					<li><a class="ipsType_blendLinks" href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=1636" data-ipstooltip title="Share this post" data-ipsmenu data-ipsmenu-closeonclick="false" id="elSharePost_1636" data-role="shareComment"><i class="fa fa-share-alt"></i></a></li>
				
				
			</ul>
		</div>

		<div class="ipsType_reset">
			<a href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=1636" class="ipsType_blendLinks">Posted <time datetime="2018-10-23T20:52:27Z" title="10/23/2018 08:52  PM" data-short="Oct 23">October 23, 2018</time></a>
			<span class="ipsResponsive_hidePhone">
				
					(edited)
				
				
			</span>
		</div>
	</div>

	


	<div class="cPost_contentWrap ipsPad">
		
		<div data-role="commentContent" class="ipsType_normal ipsType_richText ipsContained" data-controller="core.front.core.lightboxedImages">
			
<blockquote class="ipsQuote" data-ipsquote="" data-ipsquote-contentapp="forums" data-ipsquote-contentclass="forums_Topic" data-ipsquote-contentcommentid="749" data-ipsquote-contentid="362" data-ipsquote-contenttype="forums" data-ipsquote-timestamp="1504200990" data-ipsquote-userid="18089" data-ipsquote-username="Jef">
	<div class="ipsQuote_citation">
		On 8/31/2017 at 1:36 PM, Jef said:
	</div>

	<div class="ipsQuote_contents">
		<p>
			Well though its already 1 year  you posted this and might have already solved this issue. I thought of  writing the solution since I went through the same situation.<br>
			1. First Create SQL Variable on the dashboard that pulls each on &lt;th&gt; below.
		</p>

		<p>
			Select StudentNumber &lt;br&gt;, NameLast &lt;br&gt;, NameFirst&lt;br&gt;.....................
		</p>

		<p>
			From .............
		</p>

		<p>
			2. Create memo box  on the form. Suppose first for StudentNumber . Set DATAAWARE to yes. Change the TextProperty to reference SQLvariable just made above. maybe. SqlVariable1.StudentNumber. Set the visibility to No so that it wont apppear on Dashboard during execution. <br>
			3. Similarly make memo to all NameLast, NameFirst ... and do the exact same process. each memo will be like memo1, memo2, memo3.. 
		</p>

		<p>
			 
		</p>

		<p>
			4. Now in email body<br><span style="color:#000088;">&lt;table border ="1"&gt;</span><span style="color:#000000;"> </span><br><span style="color:#000088;">&lt;thead&gt;<br>
			&lt;tr&gt;</span><br><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">StudentNumber</span><span style="color:#000088;">&lt;/th&gt;</span><br><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">NameLast</span><span style="color:#000088;">&lt;/th&gt;</span><br><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">NameFirst</span><span style="color:#000088;">&lt;/th&gt;</span><br><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">Term</span><span style="color:#000088;">&lt;/th&gt;</span><span style="color:#000000;"> </span><span style="color:#000088;">&lt;<br>
			th&gt;</span><span style="color:#000000;">CheckInDate</span><span style="color:#000088;">&lt;/th&gt;</span><br><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">ContractDateStart</span><span style="color:#000088;">&lt;/th&gt;</span><span style="color:#000000;"> </span><br><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">Old</span><span style="color:#000088;">&lt;/th&gt;</span><br><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">New</span><span style="color:#000088;">&lt;/th&gt;</span><span style="color:#000000;"> </span><br><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">LogDate</span><span style="color:#000088;">&lt;/th&gt;</span><br><span style="color:#000088;">&lt;th&gt;</span><span style="color:#000000;">ModifiedBy</span><span style="color:#000088;">&lt;/th&gt;</span><span style="color:#000000;"> </span><br><span style="color:#000088;">&lt;/tr&gt;&lt;/thead&gt;</span>
		</p>

		<p>
			<span style="color:#000088;">&lt;tbody&gt;&lt;tr&gt;</span><br><span style="color:#000088;">&lt;td&gt;</span>%%:Memo1%%<span style="color:#000088;">&lt;/td&gt;</span><span style="color:#000000;"> </span><br><span style="color:#000088;">&lt;td&gt;</span>%%:Memo2%%<span style="color:#000088;">&lt;/td&gt;<br>
			&lt;td&gt;</span>%%:Memo3%%<span style="color:#000088;">&lt;/td&gt;<br>
			&lt;td&gt;</span>%%:Memo4%%<span style="color:#000088;">&lt;/td&gt;<br>
			&lt;td&gt;</span>%%:Memo5%%<span style="color:#000088;">&lt;/td&gt;<br>
			&lt;td&gt;</span>%%:Memo6%%<span style="color:#000088;">&lt;/td&gt;<br>
			&lt;td&gt;</span>%%:Memo7%%<span style="color:#000088;">&lt;/td&gt;<br>
			&lt;td&gt;</span>%%:Memo8%%<span style="color:#000088;">&lt;/td&gt;<br>
			&lt;td&gt;</span>%%:Memo9%%<span style="color:#000088;">&lt;/td&gt;<br>
			&lt;td&gt;</span>%%:Memo10%%<span style="color:#000088;">&lt;/td&gt;</span><br><br><span style="color:#000088;">&lt;/tr&gt;&lt;/tbody&gt;</span><span style="color:#000000;"> </span><span style="color:#000088;">&lt;/table&gt;<br><br><br>
			Good Luck. Give a try. </span>
		</p>
	</div>
</blockquote>

<p>
	 
</p>

<blockquote class="ipsQuote" data-ipsquote="">
	<div class="ipsQuote_citation">
		Quote
	</div>

	<div class="ipsQuote_contents">
		<pre style="border:1px solid #888888;color:#444444;font-size:14px;padding:2px;">


 </pre>

		<p>
			 
		</p>
	</div>
</blockquote>

<p>
	 
</p>


			
				

<span class="ipsType_reset ipsType_medium ipsType_light" data-excludequote>
	<strong>Edited <time datetime="2019-01-04T18:35:49Z" title="01/04/2019 06:35  PM" data-short="Jan 4">January 4</time> by Sajjan</strong>
	
	
</span>
			
		</div>

		<div class="ipsItemControls">
			
				
					

	<div data-controller="core.front.core.reaction" class="ipsItemControls_right ipsClearfix ">	
		<div class="ipsReact ipsPos_right">
			
				
				<div class="ipsReact_blurb ipsHide" data-role="reactionBlurb">
					
				</div>
			
			
			
		</div>
	</div>

				
			
			<ul class="ipsComment_controls ipsClearfix ipsItemControls_left" data-role="commentControls">
				
					
					
					
				
				<li class="ipsHide" data-role="commentLoading">
					<span class="ipsLoading ipsLoading_tiny ipsLoading_noAnim"></span>
				</li>
			</ul>
		</div>

		
	</div>

	<div class="ipsMenu ipsMenu_wide ipsHide cPostShareMenu" id="elSharePost_1636_menu">
		<div class="ipsPad">
			<h4 class="ipsType_sectionHead">Share this post</h4>
			<hr class="ipsHr">
			<h5 class="ipsType_normal ipsType_reset">Link to post</h5>
			
			<input type="text" value="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=1636" class="ipsField_fullWidth">
			

			
		</div>
	</div>
</div>
	</div>
</article><article id="elComment_1637" class="cPost ipsBox  ipsComment  ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone  ">
	

	<div class="cAuthorPane cAuthorPane_mobile ipsResponsive_showPhone ipsResponsive_block">
		<h3 class="ipsType_sectionHead cAuthorPane_author ipsResponsive_showPhone ipsResponsive_inlineBlock ipsType_break ipsType_blendLinks ipsTruncate ipsTruncate_line">
			
chamblin
			<span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 19
	
		</span>
	
</span>
		</h3>
		<div class="cAuthorPane_photo">
			

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2018_10/WIN_20180910_09_34_24_Pro_InPixio.thumb.jpg.0922146a514d08b8b8da75254902a88a.jpg" alt="chamblin">
	</span>

		</div>
	</div>
	<aside class="ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone"><h3 class="ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break">
<strong>
chamblin</strong> <span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 19
	
		</span>
	
</span>
</h3>
		
		<ul class="cAuthorPane_info ipsList_reset">
			
				<li class="ipsType_break">Advanced Member</li>
			
			
				<li><span class="ipsPip"></span><span class="ipsPip"></span><span class="ipsPip"></span></li>
			

			<li class="cAuthorPane_photo">
				

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2018_10/WIN_20180910_09_34_24_Pro_InPixio.thumb.jpg.0922146a514d08b8b8da75254902a88a.jpg" alt="chamblin">
	</span>

			</li>
			<li>Members</li>
			
			
				<li>

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 19
	
		</span>
	
</li>
				<li class="ipsType_light">64 posts</li>
				
				

			
		</ul></aside><div class="ipsColumn ipsColumn_fluid">
		

<div id="comment-1637_wrap" data-controller="core.front.core.comment" data-commentapp="forums" data-commenttype="forums" data-commentid="1637" data-quotedata='{"userid":3018,"username":"chamblin","timestamp":1540329568,"contentapp":"forums","contenttype":"forums","contentid":362,"contentclass":"forums_Topic","contentcommentid":1637}' class="ipsComment_content ipsType_medium  ipsFaded_withHover">
	

	<div class="ipsComment_meta ipsType_light">
		<div class="ipsPos_right ipsType_light ipsType_reset ipsFaded ipsFaded_more ipsType_blendLinks">
			<ul class="ipsList_inline ipsComment_tools">
				
					<li><a href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=reportComment&amp;comment=1637" data-ipsdialog data-ipsdialog-remotesubmit data-ipsdialog-size="medium" data-ipsdialog-flashmessage="Thanks for your report." data-ipsdialog-title="Report post" data-action="reportComment" title="Report this content" class="ipsFaded ipsFaded_more"><span class="ipsResponsive_showPhone ipsResponsive_inline"><i class="fa fa-flag"></i></span><span class="ipsResponsive_hidePhone ipsResponsive_inline">Report post</span></a></li>
				
				
				
					<li><a class="ipsType_blendLinks" href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=1637" data-ipstooltip title="Share this post" data-ipsmenu data-ipsmenu-closeonclick="false" id="elSharePost_1637" data-role="shareComment"><i class="fa fa-share-alt"></i></a></li>
				
				
			</ul>
		</div>

		<div class="ipsType_reset">
			<a href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=1637" class="ipsType_blendLinks">Posted <time datetime="2018-10-23T21:19:28Z" title="10/23/2018 09:19  PM" data-short="Oct 23">October 23, 2018</time></a>
			<span class="ipsResponsive_hidePhone">
				
				
			</span>
		</div>
	</div>

	


	<div class="cPost_contentWrap ipsPad">
		
		<div data-role="commentContent" class="ipsType_normal ipsType_richText ipsContained" data-controller="core.front.core.lightboxedImages">
			
<p>
	Hey, thanks!  What great timing though, I have to deliver an automated html email datablock soon!
</p>

<p>
	Candy
</p>


			
		</div>

		<div class="ipsItemControls">
			
				
					

	<div data-controller="core.front.core.reaction" class="ipsItemControls_right ipsClearfix ">	
		<div class="ipsReact ipsPos_right">
			
				
				<div class="ipsReact_blurb " data-role="reactionBlurb">
					
						

	
	<ul class="ipsReact_reactions">
	
		
			
			<li class="ipsReact_reactCount">
				
					<span data-ipstooltip title="Like">
				
						<span>
							<img src="//content.invisioncic.com/r269962/reactions/react_like.png" alt="Like">
						</span>
						<span>
							1
						</span>
				
					</span>
				
			</li>
		
	
	</ul>

<div class="ipsReact_overview ipsType_blendLinks">
	
	
</div>
					
				</div>
			
			
			
		</div>
	</div>

				
			
			<ul class="ipsComment_controls ipsClearfix ipsItemControls_left" data-role="commentControls">
				
					
					
					
				
				<li class="ipsHide" data-role="commentLoading">
					<span class="ipsLoading ipsLoading_tiny ipsLoading_noAnim"></span>
				</li>
			</ul>
		</div>

		
	</div>

	<div class="ipsMenu ipsMenu_wide ipsHide cPostShareMenu" id="elSharePost_1637_menu">
		<div class="ipsPad">
			<h4 class="ipsType_sectionHead">Share this post</h4>
			<hr class="ipsHr">
			<h5 class="ipsType_normal ipsType_reset">Link to post</h5>
			
			<input type="text" value="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=1637" class="ipsField_fullWidth">
			

			
		</div>
	</div>
</div>
	</div>
</article><article id="elComment_1652" class="cPost ipsBox  ipsComment  ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone  ">
	

	<div class="cAuthorPane cAuthorPane_mobile ipsResponsive_showPhone ipsResponsive_block">
		<h3 class="ipsType_sectionHead cAuthorPane_author ipsResponsive_showPhone ipsResponsive_inlineBlock ipsType_break ipsType_blendLinks ipsTruncate ipsTruncate_line">
			
Jon Davidson
			<span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 1
	
		</span>
	
</span>
		</h3>
		<div class="cAuthorPane_photo">
			

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2018_04/J_member_19728.png" alt="Jon Davidson">
	</span>

		</div>
	</div>
	<aside class="ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone"><h3 class="ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break">
<strong>
Jon Davidson</strong> <span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 1
	
		</span>
	
</span>
</h3>
		
		<ul class="cAuthorPane_info ipsList_reset">
			
				<li class="ipsType_break">New Member</li>
			
			
				<li><span class="ipsPip"></span></li>
			

			<li class="cAuthorPane_photo">
				

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2018_04/J_member_19728.png" alt="Jon Davidson">
	</span>

			</li>
			<li>Members</li>
			
			
				<li>

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 1
	
		</span>
	
</li>
				<li class="ipsType_light">2 posts</li>
				
				

			
		</ul></aside><div class="ipsColumn ipsColumn_fluid">
		

<div id="comment-1652_wrap" data-controller="core.front.core.comment" data-commentapp="forums" data-commenttype="forums" data-commentid="1652" data-quotedata='{"userid":19728,"username":"Jon Davidson","timestamp":1540585957,"contentapp":"forums","contenttype":"forums","contentid":362,"contentclass":"forums_Topic","contentcommentid":1652}' class="ipsComment_content ipsType_medium  ipsFaded_withHover">
	

	<div class="ipsComment_meta ipsType_light">
		<div class="ipsPos_right ipsType_light ipsType_reset ipsFaded ipsFaded_more ipsType_blendLinks">
			<ul class="ipsList_inline ipsComment_tools">
				
					<li><a href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=reportComment&amp;comment=1652" data-ipsdialog data-ipsdialog-remotesubmit data-ipsdialog-size="medium" data-ipsdialog-flashmessage="Thanks for your report." data-ipsdialog-title="Report post" data-action="reportComment" title="Report this content" class="ipsFaded ipsFaded_more"><span class="ipsResponsive_showPhone ipsResponsive_inline"><i class="fa fa-flag"></i></span><span class="ipsResponsive_hidePhone ipsResponsive_inline">Report post</span></a></li>
				
				
				
					<li><a class="ipsType_blendLinks" href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=1652" data-ipstooltip title="Share this post" data-ipsmenu data-ipsmenu-closeonclick="false" id="elSharePost_1652" data-role="shareComment"><i class="fa fa-share-alt"></i></a></li>
				
				
			</ul>
		</div>

		<div class="ipsType_reset">
			<a href="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=1652" class="ipsType_blendLinks">Posted <time datetime="2018-10-26T20:32:37Z" title="10/26/2018 08:32  PM" data-short="Oct 26">October 26, 2018</time></a>
			<span class="ipsResponsive_hidePhone">
				
					(edited)
				
				
			</span>
		</div>
	</div>

	


	<div class="cPost_contentWrap ipsPad">
		
		<div data-role="commentContent" class="ipsType_normal ipsType_richText ipsContained" data-controller="core.front.core.lightboxedImages">
			
<p>
	Coincidentally, I just developed a HTML table solution that is a bit different (simpler?) than the ideas here, but should be adaptable to use in many scenarios. Here's a write-up/explanation - I hope you like it.
</p>

<p>
	 
</p>

<p>
	The general concept is  simple - to insert the html table into your email you need to collapse the rows and columns into a single value with the html tags and your query data together. Here are the conceptual steps:
</p>

<ol><li>
		Concatenate the columns into one (with html tags for the cells and rows)
	</li>
	<li>
		Add a row at top for the header of the table
	</li>
	<li>
		Aggregate the rows into a single value
	</li>
	<li>
		Put it in the email body with a little additional html
	</li>
</ol><p>
	Let's use a simple STVTERM query as an example (note: perform your order by here):
</p>

<pre class="ipsCode prettyprint lang-sql prettyprinted">
<span class="kwd">select</span><span class="pln"> stvterm</span><span class="pun">.*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> stvterm
</span><span class="kwd">where</span><span class="pln"> stvterm_code like </span><span class="str">'%40'</span><span class="pln">
order </span><span class="kwd">by</span><span class="pln"> stvterm_start_date desc


</span></pre>

<p>
	 
</p>

<p>
	<strong>First, concatenate the columns into one (with html tags for the cells and rows):</strong>
</p>

<pre class="ipsCode prettyprint lang-sql prettyprinted">
<span class="kwd">select</span><span class="pln">
    </span><span class="str">'&lt;tr&gt;&lt;td&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
    stvterm_code </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/td&gt;&lt;td&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
    stvterm_desc </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/td&gt;&lt;td&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
    stvterm_start_date </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/td&gt;&lt;td&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
    stvterm_end_date </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/td&gt;&lt;/tr&gt;'</span><span class="pln">
    rowval
</span><span class="kwd">from</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">select</span><span class="pln"> stvterm</span><span class="pun">.*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> stvterm
    </span><span class="kwd">where</span><span class="pln"> stvterm_code like </span><span class="str">'%40'</span><span class="pln">
    order </span><span class="kwd">by</span><span class="pln"> stvterm_start_date desc</span><span class="pun">)</span></pre>

<p>
	 
</p>

<p>
	<strong>Next, add a select statement at the beginning to build the header row of the table and union all it to what you already have:</strong>
</p>

<pre class="ipsCode prettyprint lang-sql prettyprinted">
<span class="kwd">select</span><span class="pln"> </span><span class="str">'&lt;tr&gt;&lt;th align="left"&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
    </span><span class="str">'Code'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/th&gt;&lt;th align="left"&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
    </span><span class="str">'Description'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/th&gt;&lt;th align="left"&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
    </span><span class="str">'Start Date'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/th&gt;&lt;th align="left"&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
    </span><span class="str">'End Date'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/th&gt;'</span><span class="pln"> rowval
</span><span class="kwd">from</span><span class="pln"> dual
</span><span class="kwd">union</span><span class="pln"> all
</span><span class="kwd">select</span><span class="pln">
    </span><span class="str">'&lt;tr&gt;&lt;td&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
    stvterm_code </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/td&gt;&lt;td&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
    stvterm_desc </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/td&gt;&lt;td&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
    stvterm_start_date </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/td&gt;&lt;td&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
    stvterm_end_date </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/td&gt;&lt;/tr&gt;'</span><span class="pln">
    rowval
</span><span class="kwd">from</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">select</span><span class="pln"> stvterm</span><span class="pun">.*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> stvterm
    </span><span class="kwd">where</span><span class="pln"> stvterm_code like </span><span class="str">'%40'</span><span class="pln">
    order </span><span class="kwd">by</span><span class="pln"> stvterm_start_date desc</span><span class="pun">)</span></pre>

<p>
	 
</p>

<p>
	<strong>Finally, aggregate all the rows into a single value using the xmlcast and xmlagg functions:</strong>
</p>

<pre class="ipsCode prettyprint lang-sql prettyprinted">
<span class="kwd">select</span><span class="pln"> xmlcast</span><span class="pun">(</span><span class="pln">xmlagg</span><span class="pun">(</span><span class="pln">xmlelement</span><span class="pun">(</span><span class="str">"rowval"</span><span class="pun">,</span><span class="pln">rowval</span><span class="pun">)</span><span class="pln">order </span><span class="kwd">by</span><span class="pln"> rownum</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> CLOB</span><span class="pun">)</span><span class="pln"> html_table
</span><span class="kwd">from</span><span class="pln"> </span><span class="pun">(</span><span class="pln">
    </span><span class="kwd">select</span><span class="pln"> </span><span class="str">'&lt;tr&gt;&lt;th align="left"&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
        </span><span class="str">'Code'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/th&gt;&lt;th align="left"&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
        </span><span class="str">'Description'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/th&gt;&lt;th align="left"&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
        </span><span class="str">'Start Date'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/th&gt;&lt;th align="left"&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
        </span><span class="str">'End Date'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/th&gt;'</span><span class="pln"> rowval
    </span><span class="kwd">from</span><span class="pln"> dual
    </span><span class="kwd">union</span><span class="pln"> all
    </span><span class="kwd">select</span><span class="pln">
        </span><span class="str">'&lt;tr&gt;&lt;td&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
        stvterm_code </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/td&gt;&lt;td&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
        stvterm_desc </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/td&gt;&lt;td&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
        stvterm_start_date </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/td&gt;&lt;td&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
        stvterm_end_date </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/td&gt;&lt;/tr&gt;'</span><span class="pln">
        rowval
    </span><span class="kwd">from</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">select</span><span class="pln"> stvterm</span><span class="pun">.*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> stvterm
        </span><span class="kwd">where</span><span class="pln"> stvterm_code like </span><span class="str">'%40'</span><span class="pln">
        order </span><span class="kwd">by</span><span class="pln"> stvterm_start_date desc</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">)</span></pre>

<p>
	Note: you may be tempted to use listagg rather than xmlagg, but listagg has a limit of 2000 characters. I highly recommend xmlagg.
</p>

<p>
	 
</p>

<p>
	You now have everything for your html table except the &lt;table&gt; and &lt;/table&gt; tags.
</p>

<p>
	<strong>You could add those in the SQL, but I preferred to do those and the table formatting in the email body:</strong>
</p>

<pre class="ipsCode prettyprint lang-html prettyprinted">
<span class="pln">Table of Fall semesters from STVTERM:</span><span class="tag">&lt;/p&gt;</span><span class="pln">
</span><span class="tag">&lt;table</span><span class="pln">  </span><span class="atn">border</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">cellspacing</span><span class="pun">=</span><span class="atv">"0"</span><span class="pln"> </span><span class="atn">cellpadding</span><span class="pun">=</span><span class="atv">"5"</span><span class="tag">&gt;</span><span class="pln">
%%{ArgosData.html_table}%%
</span><span class="tag">&lt;/table&gt;</span></pre>

<p>
	 
</p>

<p>
	Everything described above will work; however, it has a couple drawbacks:
</p>

<ul><li>
		It will produce an email even if there are no query results
	</li>
	<li>
		You can't also produce a standard (csv, banded, etc.) report. 
	</li>
</ul><p>
	It's actually pretty easy to overcome those limitations:
</p>

<p>
	 
</p>

<p>
	<strong>Encapsulate the SQL for your html table as a column (scalar non-correlated subquery) within a standard-form version of your query:</strong>
</p>

<pre class="ipsCode prettyprint lang-sql prettyprinted">
<span class="kwd">select</span><span class="pln">
    stvterm_code </span><span class="str">"Code"</span><span class="pun">,</span><span class="pln">
    stvterm_desc </span><span class="str">"Description"</span><span class="pun">,</span><span class="pln">
    stvterm_start_date </span><span class="str">"Start_Date"</span><span class="pun">,</span><span class="pln">
    stvterm_end_date </span><span class="str">"End_Date"</span><span class="pun">,</span><span class="pln">
    </span><span class="pun">(</span><span class="kwd">select</span><span class="pln"> xmlcast</span><span class="pun">(</span><span class="pln">xmlagg</span><span class="pun">(</span><span class="pln">xmlelement</span><span class="pun">(</span><span class="str">"rowval"</span><span class="pun">,</span><span class="pln">rowval</span><span class="pun">)</span><span class="pln">order </span><span class="kwd">by</span><span class="pln"> rownum</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> CLOB</span><span class="pun">)</span><span class="pln"> html_table
    </span><span class="kwd">from</span><span class="pln"> </span><span class="pun">(</span><span class="pln">
        </span><span class="kwd">select</span><span class="pln"> </span><span class="str">'&lt;tr&gt;&lt;th align="left"&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
            </span><span class="str">'Code'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/th&gt;&lt;th align="left"&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
            </span><span class="str">'Description'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/th&gt;&lt;th align="left"&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
            </span><span class="str">'Start Date'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/th&gt;&lt;th align="left"&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
            </span><span class="str">'End Date'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/th&gt;'</span><span class="pln"> rowval
        </span><span class="kwd">from</span><span class="pln"> dual
        </span><span class="kwd">union</span><span class="pln"> all
        </span><span class="kwd">select</span><span class="pln">
            </span><span class="str">'&lt;tr&gt;&lt;td&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
            stvterm_code </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/td&gt;&lt;td&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
            stvterm_desc </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/td&gt;&lt;td&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
            stvterm_start_date </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/td&gt;&lt;td&gt;'</span><span class="pln"> </span><span class="pun">||</span><span class="pln">
            stvterm_end_date </span><span class="pun">||</span><span class="pln"> </span><span class="str">'&lt;/td&gt;&lt;/tr&gt;'</span><span class="pln">
            rowval
        </span><span class="kwd">from</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">select</span><span class="pln"> stvterm</span><span class="pun">.*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> stvterm
            </span><span class="kwd">where</span><span class="pln"> stvterm_code like </span><span class="str">'%40'</span><span class="pln">
            order </span><span class="kwd">by</span><span class="pln"> stvterm_start_date desc</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">))</span><span class="pln"> </span><span class="str">"html_table"</span><span class="pln">
</span><span class="kwd">from</span><span class="pln"> stvterm
</span><span class="kwd">where</span><span class="pln"> stvterm_code like </span><span class="str">'%40'</span><span class="pln">
order </span><span class="kwd">by</span><span class="pln"> stvterm_start_date desc</span></pre>

<p>
	 
</p>

<p>
	This will produce a regular table of results but with your html table  as the last column (the same for every row). Now you can build a standard report using all columns except the html_table field and attach it to your email. Now if the query produces no results the schedule won't run/email wont' send. You don't have to make any modifications to the send email task because it will only use the html_table value once (the "first" one). 
</p>

<p>
	 
</p>

<p>
	Hope this is helpful to others. Let me know if you have any questions I can help answer or if you have any ideas for improvement. 
</p>

<p>
	 
</p>


			
				

<span class="ipsType_reset ipsType_medium ipsType_light" data-excludequote>
	<strong>Edited <time datetime="2018-10-26T20:35:52Z" title="10/26/2018 08:35  PM" data-short="Oct 26">October 26, 2018</time> by Jon Davidson</strong>
	
	
</span>
			
		</div>

		<div class="ipsItemControls">
			
				
					

	<div data-controller="core.front.core.reaction" class="ipsItemControls_right ipsClearfix ">	
		<div class="ipsReact ipsPos_right">
			
				
				<div class="ipsReact_blurb " data-role="reactionBlurb">
					
						

	
	<ul class="ipsReact_reactions">
	
		
			
			<li class="ipsReact_reactCount">
				
					<span data-ipstooltip title="Like">
				
						<span>
							<img src="//content.invisioncic.com/r269962/reactions/react_like.png" alt="Like">
						</span>
						<span>
							1
						</span>
				
					</span>
				
			</li>
		
	
	</ul>

<div class="ipsReact_overview ipsType_blendLinks">
	
	
</div>
					
				</div>
			
			
			
		</div>
	</div>

				
			
			<ul class="ipsComment_controls ipsClearfix ipsItemControls_left" data-role="commentControls">
				
					
					
					
				
				<li class="ipsHide" data-role="commentLoading">
					<span class="ipsLoading ipsLoading_tiny ipsLoading_noAnim"></span>
				</li>
			</ul>
		</div>

		
	</div>

	<div class="ipsMenu ipsMenu_wide ipsHide cPostShareMenu" id="elSharePost_1652_menu">
		<div class="ipsPad">
			<h4 class="ipsType_sectionHead">Share this post</h4>
			<hr class="ipsHr">
			<h5 class="ipsType_normal ipsType_reset">Link to post</h5>
			
			<input type="text" value="https://archive.evisions.com/topic/362-embed-records-in-email-using-html-table/?do=findComment&amp;comment=1652" class="ipsField_fullWidth">
			

			
		</div>
	</div>
</div>
	</div>
</article>
</form></div></div></div></div></div></main></body></html>
