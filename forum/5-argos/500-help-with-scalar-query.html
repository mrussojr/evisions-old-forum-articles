<html><head>
<link rel="stylesheet" href="../../css/core.css">
<link rel="stylesheet" href="../../css/core_responsive.css">
<link rel="stylesheet" href="../../css/custom.css">
<link rel="stylesheet" href="../../css/flags.css">
<link rel="stylesheet" href="../../css/forums.css">
<link rel="stylesheet" href="../../css/forums_responsive.css">
<link rel="stylesheet" href="../../css/framework.css">
<link rel="stylesheet" href="../../css/responsive.css"></head>
<body class="ipsApp ipsApp_front ipsJS_has ipsClearfix ipsApp_noTouch" data-controller="core.front.core.app" data-message="" data-pageapp="forums" data-pagelocation="front" data-pagemodule="forums" data-pagecontroller="topic" itemscope="" itemtype="http://schema.org/WebSite">
<main role="main" id="ipsLayout_body" class="ipsLayout_container">
<div id="ipsLayout_contentArea">
<div id="ipsLayout_contentWrapper">
<div id="ipsLayout_mainArea">
<div data-controller="core.front.core.commentFeed,forums.front.topic.view, core.front.core.ignoredComments" data-autopoll="" data-baseurl="" data-lastpage="" data-feedid="topic-787" class="cTopic ipsClear ipsSpacer_top">
<div id="elPostFeed" data-role="commentFeed" data-controller="core.front.core.moderation">
<form action="" method="post" data-ipspageaction="" data-role="moderationTools">
<article id="elComment_1082" class="cPost ipsBox  ipsComment  ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone  ">
	

	<div class="cAuthorPane cAuthorPane_mobile ipsResponsive_showPhone ipsResponsive_block">
		<h3 class="ipsType_sectionHead cAuthorPane_author ipsResponsive_showPhone ipsResponsive_inlineBlock ipsType_break ipsType_blendLinks ipsTruncate ipsTruncate_line">
			
James Walke
			<span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</span>
		</h3>
		<div class="cAuthorPane_photo">
			

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_10/J.png.012a3518f086e077fef19853ca0f9920.png" alt="James Walke">
	</span>

		</div>
	</div>
	<aside class="ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone"><h3 class="ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break">
<strong>
James Walke</strong> <span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</span>
</h3>
		
		<ul class="cAuthorPane_info ipsList_reset">
			
				<li class="ipsType_break">New Member</li>
			
			
				<li><span class="ipsPip"></span></li>
			

			<li class="cAuthorPane_photo">
				

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_10/J.png.012a3518f086e077fef19853ca0f9920.png" alt="James Walke">
	</span>

			</li>
			<li>Members</li>
			
			
				<li>

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</li>
				<li class="ipsType_light">3 posts</li>
				
				

			
		</ul></aside><div class="ipsColumn ipsColumn_fluid">
		

<div id="comment-1082_wrap" data-controller="core.front.core.comment" data-commentapp="forums" data-commenttype="forums" data-commentid="1082" data-quotedata='{"userid":15899,"username":"James Walke","timestamp":1517415620,"contentapp":"forums","contenttype":"forums","contentid":500,"contentclass":"forums_Topic","contentcommentid":1082}' class="ipsComment_content ipsType_medium  ipsFaded_withHover">
	

	<div class="ipsComment_meta ipsType_light">
		<div class="ipsPos_right ipsType_light ipsType_reset ipsFaded ipsFaded_more ipsType_blendLinks">
			<ul class="ipsList_inline ipsComment_tools">
				
					<li><a href="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=reportComment&amp;comment=1082" data-ipsdialog data-ipsdialog-remotesubmit data-ipsdialog-size="medium" data-ipsdialog-flashmessage="Thanks for your report." data-ipsdialog-title="Report post" data-action="reportComment" title="Report this content" class="ipsFaded ipsFaded_more"><span class="ipsResponsive_showPhone ipsResponsive_inline"><i class="fa fa-flag"></i></span><span class="ipsResponsive_hidePhone ipsResponsive_inline">Report post</span></a></li>
				
				
				
					<li><a class="ipsType_blendLinks" href="https://archive.evisions.com/topic/500-help-with-scalar-query/" data-ipstooltip title="Share this post" data-ipsmenu data-ipsmenu-closeonclick="false" id="elSharePost_1082" data-role="shareComment"><i class="fa fa-share-alt"></i></a></li>
				
				
			</ul>
		</div>

		<div class="ipsType_reset">
			<a href="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=findComment&amp;comment=1082" class="ipsType_blendLinks">Posted <time datetime="2018-01-31T16:20:20Z" title="01/31/2018 04:20  PM" data-short="1 yr">January 31, 2018</time></a>
			<span class="ipsResponsive_hidePhone">
				
				
			</span>
		</div>
	</div>

	


	<div class="cPost_contentWrap ipsPad">
		
		<div data-role="commentContent" class="ipsType_normal ipsType_richText ipsContained" data-controller="core.front.core.lightboxedImages">
			
<p>
	I wrote a scalar query to pull the high school codes of all enrolled students. The query generates multiple rows and I have not been able to determine the problem with my code. Any insights into what I am doing incorrectly are sincerely appreciated. My code:
</p>

<p>
	 
</p>

<p>
	NVL(CASE<br>
	    WHEN SGBSTDN.SGBSTDN_STYP_CODE IN ('T','J')<br>
	    THEN '990001'<br>
	    WHEN SGBSTDN.SGBSTDN_RESD_CODE = 'N'<br>
	    THEN '990003'<br>
	    WHEN SGBSTDN.SGBSTDN_LEVL_CODE = 'GR'<br>
	    THEN '990004'<br>
	    ELSE  (SELECT CASE<br>
	                      WHEN SORHSCH.SORHSCH_SBGI_CODE = 'GED'<br>
	                      THEN '990002'<br>
	                      ELSE SORHSCH_SBGI_CODE<br>
	                  END
</p>

<p>
	        FROM SORHSCH<br>
	        WHERE SORHSCH_PIDM = SFBETRM_PIDM<br>
	         AND SORHSCH_GRADUATION_DATE =<br>
	             (SELECT MAX(X.SORHSCH_GRADUATION_DATE)<br>
	               FROM SORHSCH X<br>
	             WHERE X.SORHSCH_PIDM = SORHSCH.SORHSCH_PIDM))<br>
	END, '999999')
</p>


			
		</div>

		<div class="ipsItemControls">
			
				
					

	<div data-controller="core.front.core.reaction" class="ipsItemControls_right ipsClearfix ">	
		<div class="ipsReact ipsPos_right">
			
				
				<div class="ipsReact_blurb ipsHide" data-role="reactionBlurb">
					
				</div>
			
			
			
		</div>
	</div>

				
			
			<ul class="ipsComment_controls ipsClearfix ipsItemControls_left" data-role="commentControls">
				
					
					
					
				
				<li class="ipsHide" data-role="commentLoading">
					<span class="ipsLoading ipsLoading_tiny ipsLoading_noAnim"></span>
				</li>
			</ul>
		</div>

		
	</div>

	<div class="ipsMenu ipsMenu_wide ipsHide cPostShareMenu" id="elSharePost_1082_menu">
		<div class="ipsPad">
			<h4 class="ipsType_sectionHead">Share this post</h4>
			<hr class="ipsHr">
			<h5 class="ipsType_normal ipsType_reset">Link to post</h5>
			
			<input type="text" value="https://archive.evisions.com/topic/500-help-with-scalar-query/" class="ipsField_fullWidth">
			

			
		</div>
	</div>
</div>
	</div>
</article><article id="elComment_1083" class="cPost ipsBox  ipsComment  ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone  ">
	

	<div class="cAuthorPane cAuthorPane_mobile ipsResponsive_showPhone ipsResponsive_block">
		<h3 class="ipsType_sectionHead cAuthorPane_author ipsResponsive_showPhone ipsResponsive_inlineBlock ipsType_break ipsType_blendLinks ipsTruncate ipsTruncate_line">
			
Lynda Baker
			<span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</span>
		</h3>
		<div class="cAuthorPane_photo">
			

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_10/L.png.e0fafda33fe229fb534577875b26a3aa.png" alt="Lynda Baker">
	</span>

		</div>
	</div>
	<aside class="ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone"><h3 class="ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break">
<strong>
Lynda Baker</strong> <span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</span>
</h3>
		
		<ul class="cAuthorPane_info ipsList_reset">
			
				<li class="ipsType_break">New Member</li>
			
			
				<li><span class="ipsPip"></span></li>
			

			<li class="cAuthorPane_photo">
				

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_10/L.png.e0fafda33fe229fb534577875b26a3aa.png" alt="Lynda Baker">
	</span>

			</li>
			<li>Members</li>
			
			
				<li>

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</li>
				<li class="ipsType_light">6 posts</li>
				
				

			
		</ul></aside><div class="ipsColumn ipsColumn_fluid">
		

<div id="comment-1083_wrap" data-controller="core.front.core.comment" data-commentapp="forums" data-commenttype="forums" data-commentid="1083" data-quotedata='{"userid":388,"username":"Lynda Baker","timestamp":1517419382,"contentapp":"forums","contenttype":"forums","contentid":500,"contentclass":"forums_Topic","contentcommentid":1083}' class="ipsComment_content ipsType_medium  ipsFaded_withHover">
	

	<div class="ipsComment_meta ipsType_light">
		<div class="ipsPos_right ipsType_light ipsType_reset ipsFaded ipsFaded_more ipsType_blendLinks">
			<ul class="ipsList_inline ipsComment_tools">
				
					<li><a href="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=reportComment&amp;comment=1083" data-ipsdialog data-ipsdialog-remotesubmit data-ipsdialog-size="medium" data-ipsdialog-flashmessage="Thanks for your report." data-ipsdialog-title="Report post" data-action="reportComment" title="Report this content" class="ipsFaded ipsFaded_more"><span class="ipsResponsive_showPhone ipsResponsive_inline"><i class="fa fa-flag"></i></span><span class="ipsResponsive_hidePhone ipsResponsive_inline">Report post</span></a></li>
				
				
				
					<li><a class="ipsType_blendLinks" href="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=findComment&amp;comment=1083" data-ipstooltip title="Share this post" data-ipsmenu data-ipsmenu-closeonclick="false" id="elSharePost_1083" data-role="shareComment"><i class="fa fa-share-alt"></i></a></li>
				
				
			</ul>
		</div>

		<div class="ipsType_reset">
			<a href="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=findComment&amp;comment=1083" class="ipsType_blendLinks">Posted <time datetime="2018-01-31T17:23:02Z" title="01/31/2018 05:23  PM" data-short="1 yr">January 31, 2018</time></a>
			<span class="ipsResponsive_hidePhone">
				
				
			</span>
		</div>
	</div>

	


	<div class="cPost_contentWrap ipsPad">
		
		<div data-role="commentContent" class="ipsType_normal ipsType_richText ipsContained" data-controller="core.front.core.lightboxedImages">
			
<p>
	I don't know what your objective is, but there are a few things that seem odd about your query statement.
</p>

<p>
	It doesn't have a select clause, to select nvl(....), nor a "from sgbstdn".  You reference "SFBETRM_PIDM", but no table in the from clause has such a column.
</p>

<p>
	I wonder, is this what you are after?
</p>

<pre class="ipsCode prettyprint lang-html prettyprinted">
<span class="pln">select NVL(
DECODE(stdn.SGBSTDN_STYP_CODE
      ,'T','990001'
      ,'J','990001'
      ,DECODE(stdn.SGBSTDN_RESD_CODE
             ,'N', '990003'
             ,DECODE(stdn.SGBSTDN_LEVL_CODE
                    ,'GR','990004'
                    ,(SELECT decode(hsch.SORHSCH_SBGI_CODE 
                                   ,'GED', '990002'
                                   ,hsch.SORHSCH_SBGI_CODE)
                        FROM SORHSCH hsch
                       WHERE SORHSCH_PIDM = stdn.SGBSTDN_PIDM
                         AND SORHSCH_GRADUATION_DATE = (SELECT MAX(X.SORHSCH_GRADUATION_DATE)
                                                          FROM SORHSCH X
                                                          WHERE X.SORHSCH_PIDM = hsch.SORHSCH_PIDM)
                      )
                    )
             )
      )
      ,'999999') some_value
FROM SGBSTDN stdn
   ;</span></pre>

<p>
	 
</p>


			
		</div>

		<div class="ipsItemControls">
			
				
					

	<div data-controller="core.front.core.reaction" class="ipsItemControls_right ipsClearfix ">	
		<div class="ipsReact ipsPos_right">
			
				
				<div class="ipsReact_blurb ipsHide" data-role="reactionBlurb">
					
				</div>
			
			
			
		</div>
	</div>

				
			
			<ul class="ipsComment_controls ipsClearfix ipsItemControls_left" data-role="commentControls">
				
					
					
					
				
				<li class="ipsHide" data-role="commentLoading">
					<span class="ipsLoading ipsLoading_tiny ipsLoading_noAnim"></span>
				</li>
			</ul>
		</div>

		
	</div>

	<div class="ipsMenu ipsMenu_wide ipsHide cPostShareMenu" id="elSharePost_1083_menu">
		<div class="ipsPad">
			<h4 class="ipsType_sectionHead">Share this post</h4>
			<hr class="ipsHr">
			<h5 class="ipsType_normal ipsType_reset">Link to post</h5>
			
			<input type="text" value="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=findComment&amp;comment=1083" class="ipsField_fullWidth">
			

			
		</div>
	</div>
</div>
	</div>
</article><article id="elComment_1084" class="cPost ipsBox  ipsComment  ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone  ">
	

	<div class="cAuthorPane cAuthorPane_mobile ipsResponsive_showPhone ipsResponsive_block">
		<h3 class="ipsType_sectionHead cAuthorPane_author ipsResponsive_showPhone ipsResponsive_inlineBlock ipsType_break ipsType_blendLinks ipsTruncate ipsTruncate_line">
			
Lynda Baker
			<span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</span>
		</h3>
		<div class="cAuthorPane_photo">
			

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_10/L.png.e0fafda33fe229fb534577875b26a3aa.png" alt="Lynda Baker">
	</span>

		</div>
	</div>
	<aside class="ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone"><h3 class="ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break">
<strong>
Lynda Baker</strong> <span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</span>
</h3>
		
		<ul class="cAuthorPane_info ipsList_reset">
			
				<li class="ipsType_break">New Member</li>
			
			
				<li><span class="ipsPip"></span></li>
			

			<li class="cAuthorPane_photo">
				

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_10/L.png.e0fafda33fe229fb534577875b26a3aa.png" alt="Lynda Baker">
	</span>

			</li>
			<li>Members</li>
			
			
				<li>

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</li>
				<li class="ipsType_light">6 posts</li>
				
				

			
		</ul></aside><div class="ipsColumn ipsColumn_fluid">
		

<div id="comment-1084_wrap" data-controller="core.front.core.comment" data-commentapp="forums" data-commenttype="forums" data-commentid="1084" data-quotedata='{"userid":388,"username":"Lynda Baker","timestamp":1517421490,"contentapp":"forums","contenttype":"forums","contentid":500,"contentclass":"forums_Topic","contentcommentid":1084}' class="ipsComment_content ipsType_medium  ipsFaded_withHover">
	

	<div class="ipsComment_meta ipsType_light">
		<div class="ipsPos_right ipsType_light ipsType_reset ipsFaded ipsFaded_more ipsType_blendLinks">
			<ul class="ipsList_inline ipsComment_tools">
				
					<li><a href="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=reportComment&amp;comment=1084" data-ipsdialog data-ipsdialog-remotesubmit data-ipsdialog-size="medium" data-ipsdialog-flashmessage="Thanks for your report." data-ipsdialog-title="Report post" data-action="reportComment" title="Report this content" class="ipsFaded ipsFaded_more"><span class="ipsResponsive_showPhone ipsResponsive_inline"><i class="fa fa-flag"></i></span><span class="ipsResponsive_hidePhone ipsResponsive_inline">Report post</span></a></li>
				
				
				
					<li><a class="ipsType_blendLinks" href="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=findComment&amp;comment=1084" data-ipstooltip title="Share this post" data-ipsmenu data-ipsmenu-closeonclick="false" id="elSharePost_1084" data-role="shareComment"><i class="fa fa-share-alt"></i></a></li>
				
				
			</ul>
		</div>

		<div class="ipsType_reset">
			<a href="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=findComment&amp;comment=1084" class="ipsType_blendLinks">Posted <time datetime="2018-01-31T17:58:10Z" title="01/31/2018 05:58  PM" data-short="1 yr">January 31, 2018</time></a>
			<span class="ipsResponsive_hidePhone">
				
					(edited)
				
				
			</span>
		</div>
	</div>

	


	<div class="cPost_contentWrap ipsPad">
		
		<div data-role="commentContent" class="ipsType_normal ipsType_richText ipsContained" data-controller="core.front.core.lightboxedImages">
			
<pre class="ipsCode prettyprint lang-html prettyprinted">
<span class="pln">select stdn.SGBSTDN_PIDM
     , stdn.SGBSTDN_STYP_CODE
     , stdn.SGBSTDN_RESD_CODE
     , stdn.SGBSTDN_LEVL_CODE,
       NVL(
       CASE
       WHEN stdn.SGBSTDN_STYP_CODE in ('T','J')
       THEN '990001'
       WHEN stdn.SGBSTDN_RESD_CODE = 'N'
       THEN '990003'
       WHEN stdn.SGBSTDN_LEVL_CODE = 'GR'
       THEN '990004'
       ELSE (SELECT decode(hsch.SORHSCH_SBGI_CODE 
                          ,'GED', '990002'
                          ,hsch.SORHSCH_SBGI_CODE)
                        FROM SORHSCH hsch
                       WHERE SORHSCH_PIDM = stdn.SGBSTDN_PIDM
                         AND SORHSCH_GRADUATION_DATE = (SELECT MAX(X.SORHSCH_GRADUATION_DATE)
                                                          FROM SORHSCH X
                                                          WHERE X.SORHSCH_PIDM = hsch.SORHSCH_PIDM)
                      )                    
       END
      ,'999999') some_value
FROM SGBSTDN stdn
where stdn.sgbstdn_pidm = :STUDENT_PIDM_VALUE
group by stdn.SGBSTDN_STYP_CODE
       , stdn.SGBSTDN_RESD_CODE
       , stdn.SGBSTDN_LEVL_CODE
       , stdn.SGBSTDN_PIDM
    ;</span></pre>

<p>
	This version show's your CASE statement, and  optional WHERE and Group by  clauses, plus some selected columns, which may help you evaluate what is being returned from your list of values  query.
</p>


			
				

<span class="ipsType_reset ipsType_medium ipsType_light" data-excludequote>
	<strong>Edited <time datetime="2018-01-31T18:01:58Z" title="01/31/2018 06:01  PM" data-short="1 yr">January 31, 2018</time> by Lynda Baker</strong>
	
	
</span>
			
		</div>

		<div class="ipsItemControls">
			
				
					

	<div data-controller="core.front.core.reaction" class="ipsItemControls_right ipsClearfix ">	
		<div class="ipsReact ipsPos_right">
			
				
				<div class="ipsReact_blurb ipsHide" data-role="reactionBlurb">
					
				</div>
			
			
			
		</div>
	</div>

				
			
			<ul class="ipsComment_controls ipsClearfix ipsItemControls_left" data-role="commentControls">
				
					
					
					
				
				<li class="ipsHide" data-role="commentLoading">
					<span class="ipsLoading ipsLoading_tiny ipsLoading_noAnim"></span>
				</li>
			</ul>
		</div>

		
	</div>

	<div class="ipsMenu ipsMenu_wide ipsHide cPostShareMenu" id="elSharePost_1084_menu">
		<div class="ipsPad">
			<h4 class="ipsType_sectionHead">Share this post</h4>
			<hr class="ipsHr">
			<h5 class="ipsType_normal ipsType_reset">Link to post</h5>
			
			<input type="text" value="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=findComment&amp;comment=1084" class="ipsField_fullWidth">
			

			
		</div>
	</div>
</div>
	</div>
</article><article id="elComment_1085" class="cPost ipsBox  ipsComment  ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone  ">
	

	<div class="cAuthorPane cAuthorPane_mobile ipsResponsive_showPhone ipsResponsive_block">
		<h3 class="ipsType_sectionHead cAuthorPane_author ipsResponsive_showPhone ipsResponsive_inlineBlock ipsType_break ipsType_blendLinks ipsTruncate ipsTruncate_line">
			
James Walke
			<span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</span>
		</h3>
		<div class="cAuthorPane_photo">
			

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_10/J.png.012a3518f086e077fef19853ca0f9920.png" alt="James Walke">
	</span>

		</div>
	</div>
	<aside class="ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone"><h3 class="ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break">
<strong>
James Walke</strong> <span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</span>
</h3>
		
		<ul class="cAuthorPane_info ipsList_reset">
			
				<li class="ipsType_break">New Member</li>
			
			
				<li><span class="ipsPip"></span></li>
			

			<li class="cAuthorPane_photo">
				

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_10/J.png.012a3518f086e077fef19853ca0f9920.png" alt="James Walke">
	</span>

			</li>
			<li>Members</li>
			
			
				<li>

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</li>
				<li class="ipsType_light">3 posts</li>
				
				

			
		</ul></aside><div class="ipsColumn ipsColumn_fluid">
		

<div id="comment-1085_wrap" data-controller="core.front.core.comment" data-commentapp="forums" data-commenttype="forums" data-commentid="1085" data-quotedata='{"userid":15899,"username":"James Walke","timestamp":1517424313,"contentapp":"forums","contenttype":"forums","contentid":500,"contentclass":"forums_Topic","contentcommentid":1085}' class="ipsComment_content ipsType_medium  ipsFaded_withHover">
	

	<div class="ipsComment_meta ipsType_light">
		<div class="ipsPos_right ipsType_light ipsType_reset ipsFaded ipsFaded_more ipsType_blendLinks">
			<ul class="ipsList_inline ipsComment_tools">
				
					<li><a href="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=reportComment&amp;comment=1085" data-ipsdialog data-ipsdialog-remotesubmit data-ipsdialog-size="medium" data-ipsdialog-flashmessage="Thanks for your report." data-ipsdialog-title="Report post" data-action="reportComment" title="Report this content" class="ipsFaded ipsFaded_more"><span class="ipsResponsive_showPhone ipsResponsive_inline"><i class="fa fa-flag"></i></span><span class="ipsResponsive_hidePhone ipsResponsive_inline">Report post</span></a></li>
				
				
				
					<li><a class="ipsType_blendLinks" href="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=findComment&amp;comment=1085" data-ipstooltip title="Share this post" data-ipsmenu data-ipsmenu-closeonclick="false" id="elSharePost_1085" data-role="shareComment"><i class="fa fa-share-alt"></i></a></li>
				
				
			</ul>
		</div>

		<div class="ipsType_reset">
			<a href="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=findComment&amp;comment=1085" class="ipsType_blendLinks">Posted <time datetime="2018-01-31T18:45:13Z" title="01/31/2018 06:45  PM" data-short="1 yr">January 31, 2018</time></a>
			<span class="ipsResponsive_hidePhone">
				
				
			</span>
		</div>
	</div>

	


	<div class="cPost_contentWrap ipsPad">
		
		<div data-role="commentContent" class="ipsType_normal ipsType_richText ipsContained" data-controller="core.front.core.lightboxedImages">
			
<p>
	Hello, Linda.
</p>

<p>
	 
</p>

<p>
	Thank you for your response.  Your suggestion was very helpful. The code I posted is a snippet from a larger data block that generates an enrollment file.  My problem is there are a handful of records that pull multiple high school codes. I tried to isolate records based on most recent high school graduation date. For some reason that did not work. However, when I changed my code to look for the most recent SORHSCH record (using activity date) I was able to get the query to return one record per student.
</p>

<p>
	 
</p>

<p>
	Again, many thanks!!
</p>

<p>
	 
</p>

<p>
	My full corrected code is:
</p>

<p>
	 
</p>

<p>
	select SFBETRM.SFBETRM_PIDM "PIDM",<br>
	       NVL(CASE<br>
	           WHEN SGBSTDN.SGBSTDN_STYP_CODE IN ('T','J')<br>
	           THEN '990001'<br>
	           WHEN SGBSTDN.SGBSTDN_RESD_CODE = 'N'<br>
	           THEN '990003'<br>
	           WHEN SGBSTDN.SGBSTDN_LEVL_CODE = 'GR'<br>
	           THEN '990004'<br>
	           ELSE  (SELECT CASE<br>
	                             WHEN SORHSCH.SORHSCH_SBGI_CODE = 'GED'<br>
	                             THEN '990002'<br>
	                             ELSE SORHSCH_SBGI_CODE<br>
	                         END<br>
	      <br>
	               FROM SORHSCH<br>
	               WHERE SORHSCH_PIDM = SFBETRM_PIDM<br>
	                AND SORHSCH_ACTIVITY_DATE =<br>
	                    (SELECT MAX(X.SORHSCH_ACTIVITY_DATE)<br>
	                      FROM SORHSCH X<br>
	                    WHERE X.SORHSCH_PIDM = SORHSCH.SORHSCH_PIDM))<br>
	       END, '999999') "HSCODE"<br>
	  from SATURN.SFBETRM SFBETRM,<br>
	       SATURN.SGBSTDN SGBSTDN<br>
	 where ( SFBETRM.SFBETRM_PIDM = SGBSTDN.SGBSTDN_PIDM )<br>
	   and ( SFBETRM.SFBETRM_TERM_CODE = '201770'<br>
	         and F_REGISTERED_THIS_TERM(SFBETRM.SFBETRM_PIDM,SFBETRM.SFBETRM_TERM_CODE) = 'Y'<br>
	         and F_GET_SGBSTDN_ROWID(SFBETRM.SFBETRM_PIDM,SFBETRM.SFBETRM_TERM_CODE) = SGBSTDN.ROWID )<br>
	 order by SFBETRM.SFBETRM_PIDM<br>
	 
</p>

<p>
	 
</p>


			
		</div>

		<div class="ipsItemControls">
			
				
					

	<div data-controller="core.front.core.reaction" class="ipsItemControls_right ipsClearfix ">	
		<div class="ipsReact ipsPos_right">
			
				
				<div class="ipsReact_blurb ipsHide" data-role="reactionBlurb">
					
				</div>
			
			
			
		</div>
	</div>

				
			
			<ul class="ipsComment_controls ipsClearfix ipsItemControls_left" data-role="commentControls">
				
					
					
					
				
				<li class="ipsHide" data-role="commentLoading">
					<span class="ipsLoading ipsLoading_tiny ipsLoading_noAnim"></span>
				</li>
			</ul>
		</div>

		
	</div>

	<div class="ipsMenu ipsMenu_wide ipsHide cPostShareMenu" id="elSharePost_1085_menu">
		<div class="ipsPad">
			<h4 class="ipsType_sectionHead">Share this post</h4>
			<hr class="ipsHr">
			<h5 class="ipsType_normal ipsType_reset">Link to post</h5>
			
			<input type="text" value="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=findComment&amp;comment=1085" class="ipsField_fullWidth">
			

			
		</div>
	</div>
</div>
	</div>
</article><article id="elComment_1086" class="cPost ipsBox  ipsComment  ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone  ">
	

	<div class="cAuthorPane cAuthorPane_mobile ipsResponsive_showPhone ipsResponsive_block">
		<h3 class="ipsType_sectionHead cAuthorPane_author ipsResponsive_showPhone ipsResponsive_inlineBlock ipsType_break ipsType_blendLinks ipsTruncate ipsTruncate_line">
			
Lynne Hoatson
			<span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 4
	
		</span>
	
</span>
		</h3>
		<div class="cAuthorPane_photo">
			

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_05/Logo-ABAC-StallionShield-100wx100h.thumb.gif.d9cf164a759f96478eff873a2a502235.gif" alt="Lynne Hoatson">
	</span>

		</div>
	</div>
	<aside class="ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone"><h3 class="ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break">
<strong>
Lynne Hoatson</strong> <span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 4
	
		</span>
	
</span>
</h3>
		
		<ul class="cAuthorPane_info ipsList_reset">
			
				<li class="ipsType_break">Member</li>
			
			
				<li><span class="ipsPip"></span><span class="ipsPip"></span></li>
			

			<li class="cAuthorPane_photo">
				

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_05/Logo-ABAC-StallionShield-100wx100h.thumb.gif.d9cf164a759f96478eff873a2a502235.gif" alt="Lynne Hoatson">
	</span>

			</li>
			<li>Members</li>
			
			
				<li>

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 4
	
		</span>
	
</li>
				<li class="ipsType_light">22 posts</li>
				
				

			
		</ul></aside><div class="ipsColumn ipsColumn_fluid">
		

<div id="comment-1086_wrap" data-controller="core.front.core.comment" data-commentapp="forums" data-commenttype="forums" data-commentid="1086" data-quotedata='{"userid":9294,"username":"Lynne Hoatson","timestamp":1517494021,"contentapp":"forums","contenttype":"forums","contentid":500,"contentclass":"forums_Topic","contentcommentid":1086}' class="ipsComment_content ipsType_medium  ipsFaded_withHover">
	

	<div class="ipsComment_meta ipsType_light">
		<div class="ipsPos_right ipsType_light ipsType_reset ipsFaded ipsFaded_more ipsType_blendLinks">
			<ul class="ipsList_inline ipsComment_tools">
				
					<li><a href="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=reportComment&amp;comment=1086" data-ipsdialog data-ipsdialog-remotesubmit data-ipsdialog-size="medium" data-ipsdialog-flashmessage="Thanks for your report." data-ipsdialog-title="Report post" data-action="reportComment" title="Report this content" class="ipsFaded ipsFaded_more"><span class="ipsResponsive_showPhone ipsResponsive_inline"><i class="fa fa-flag"></i></span><span class="ipsResponsive_hidePhone ipsResponsive_inline">Report post</span></a></li>
				
				
				
					<li><a class="ipsType_blendLinks" href="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=findComment&amp;comment=1086" data-ipstooltip title="Share this post" data-ipsmenu data-ipsmenu-closeonclick="false" id="elSharePost_1086" data-role="shareComment"><i class="fa fa-share-alt"></i></a></li>
				
				
			</ul>
		</div>

		<div class="ipsType_reset">
			<a href="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=findComment&amp;comment=1086" class="ipsType_blendLinks">Posted <time datetime="2018-02-01T14:07:01Z" title="02/01/2018 02:07  PM" data-short="1 yr">February 1, 2018</time></a>
			<span class="ipsResponsive_hidePhone">
				
				
			</span>
		</div>
	</div>

	


	<div class="cPost_contentWrap ipsPad">
		
		<div data-role="commentContent" class="ipsType_normal ipsType_richText ipsContained" data-controller="core.front.core.lightboxedImages">
			
<p>
	As you discovered, a student can have attended more than one high school (most commonly when the family moves to a new area).  But, you may find that Activity Date doesn't always get you the last high school attended (if that's what your users need). This will depend on the data entry procedures used. 
</p>

<p>
	<br>
	At my school, data is generally entered in the order received and it's quite possible to receive HS transcripts out of "attendance" order.  That means that the Activity Date (the last time someone entered/updated the record) might be latest for the first HS a student attended vs. the Activity Date on the last HS attended/graduated from .  IIRC, there's no field in Banner to indicate the actual attendance order so you might have to check other places to approximate which is the last HS.  That all depends on how critical it is to see only the last HS though.    
</p>


			
		</div>

		<div class="ipsItemControls">
			
				
					

	<div data-controller="core.front.core.reaction" class="ipsItemControls_right ipsClearfix ">	
		<div class="ipsReact ipsPos_right">
			
				
				<div class="ipsReact_blurb ipsHide" data-role="reactionBlurb">
					
				</div>
			
			
			
		</div>
	</div>

				
			
			<ul class="ipsComment_controls ipsClearfix ipsItemControls_left" data-role="commentControls">
				
					
					
					
				
				<li class="ipsHide" data-role="commentLoading">
					<span class="ipsLoading ipsLoading_tiny ipsLoading_noAnim"></span>
				</li>
			</ul>
		</div>

		
	</div>

	<div class="ipsMenu ipsMenu_wide ipsHide cPostShareMenu" id="elSharePost_1086_menu">
		<div class="ipsPad">
			<h4 class="ipsType_sectionHead">Share this post</h4>
			<hr class="ipsHr">
			<h5 class="ipsType_normal ipsType_reset">Link to post</h5>
			
			<input type="text" value="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=findComment&amp;comment=1086" class="ipsField_fullWidth">
			

			
		</div>
	</div>
</div>
	</div>
</article><article id="elComment_1087" class="cPost ipsBox  ipsComment  ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone  ">
	

	<div class="cAuthorPane cAuthorPane_mobile ipsResponsive_showPhone ipsResponsive_block">
		<h3 class="ipsType_sectionHead cAuthorPane_author ipsResponsive_showPhone ipsResponsive_inlineBlock ipsType_break ipsType_blendLinks ipsTruncate ipsTruncate_line">
			
Johnson@oakland.edu
			<span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 11
	
		</span>
	
</span>
		</h3>
		<div class="cAuthorPane_photo">
			

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_10/J.png.26fbb477cb160ee672fded087528a951.png" alt="Johnson@oakland.edu">
	</span>

		</div>
	</div>
	<aside class="ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone"><h3 class="ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break">
<strong>
Johnson@oakland.edu</strong> <span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 11
	
		</span>
	
</span>
</h3>
		
		<ul class="cAuthorPane_info ipsList_reset">
			
				<li class="ipsType_break">Advanced Member</li>
			
			
				<li><span class="ipsPip"></span><span class="ipsPip"></span><span class="ipsPip"></span></li>
			

			<li class="cAuthorPane_photo">
				

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_10/J.png.26fbb477cb160ee672fded087528a951.png" alt="Johnson@oakland.edu">
	</span>

			</li>
			<li>Members</li>
			
			
				<li>

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 11
	
		</span>
	
</li>
				<li class="ipsType_light">34 posts</li>
				
				

			
		</ul></aside><div class="ipsColumn ipsColumn_fluid">
		

<div id="comment-1087_wrap" data-controller="core.front.core.comment" data-commentapp="forums" data-commenttype="forums" data-commentid="1087" data-quotedata='{"userid":13325,"username":"Johnson@oakland.edu","timestamp":1517495010,"contentapp":"forums","contenttype":"forums","contentid":500,"contentclass":"forums_Topic","contentcommentid":1087}' class="ipsComment_content ipsType_medium  ipsFaded_withHover">
	

	<div class="ipsComment_meta ipsType_light">
		<div class="ipsPos_right ipsType_light ipsType_reset ipsFaded ipsFaded_more ipsType_blendLinks">
			<ul class="ipsList_inline ipsComment_tools">
				
					<li><a href="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=reportComment&amp;comment=1087" data-ipsdialog data-ipsdialog-remotesubmit data-ipsdialog-size="medium" data-ipsdialog-flashmessage="Thanks for your report." data-ipsdialog-title="Report post" data-action="reportComment" title="Report this content" class="ipsFaded ipsFaded_more"><span class="ipsResponsive_showPhone ipsResponsive_inline"><i class="fa fa-flag"></i></span><span class="ipsResponsive_hidePhone ipsResponsive_inline">Report post</span></a></li>
				
				
				
					<li><a class="ipsType_blendLinks" href="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=findComment&amp;comment=1087" data-ipstooltip title="Share this post" data-ipsmenu data-ipsmenu-closeonclick="false" id="elSharePost_1087" data-role="shareComment"><i class="fa fa-share-alt"></i></a></li>
				
				
			</ul>
		</div>

		<div class="ipsType_reset">
			<a href="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=findComment&amp;comment=1087" class="ipsType_blendLinks">Posted <time datetime="2018-02-01T14:23:30Z" title="02/01/2018 02:23  PM" data-short="1 yr">February 1, 2018</time></a>
			<span class="ipsResponsive_hidePhone">
				
				
			</span>
		</div>
	</div>

	


	<div class="cPost_contentWrap ipsPad">
		
		<div data-role="commentContent" class="ipsType_normal ipsType_richText ipsContained" data-controller="core.front.core.lightboxedImages">
			
<p>
	Sometimes we pull the most recent and accept whatever the query returns. If we want the whole picture, I use the listagg function to return all schools. Not sure if that suits your needs, but it is handy.
</p>

<p>
	 
</p>


			
		</div>

		<div class="ipsItemControls">
			
				
					

	<div data-controller="core.front.core.reaction" class="ipsItemControls_right ipsClearfix ">	
		<div class="ipsReact ipsPos_right">
			
				
				<div class="ipsReact_blurb ipsHide" data-role="reactionBlurb">
					
				</div>
			
			
			
		</div>
	</div>

				
			
			<ul class="ipsComment_controls ipsClearfix ipsItemControls_left" data-role="commentControls">
				
					
					
					
				
				<li class="ipsHide" data-role="commentLoading">
					<span class="ipsLoading ipsLoading_tiny ipsLoading_noAnim"></span>
				</li>
			</ul>
		</div>

		
	</div>

	<div class="ipsMenu ipsMenu_wide ipsHide cPostShareMenu" id="elSharePost_1087_menu">
		<div class="ipsPad">
			<h4 class="ipsType_sectionHead">Share this post</h4>
			<hr class="ipsHr">
			<h5 class="ipsType_normal ipsType_reset">Link to post</h5>
			
			<input type="text" value="https://archive.evisions.com/topic/500-help-with-scalar-query/?do=findComment&amp;comment=1087" class="ipsField_fullWidth">
			

			
		</div>
	</div>
</div>
	</div>
</article>
</form></div></div></div></div></div></main></body></html>
