<html><head>
<link rel="stylesheet" href="../../css/core.css">
<link rel="stylesheet" href="../../css/core_responsive.css">
<link rel="stylesheet" href="../../css/custom.css">
<link rel="stylesheet" href="../../css/flags.css">
<link rel="stylesheet" href="../../css/forums.css">
<link rel="stylesheet" href="../../css/forums_responsive.css">
<link rel="stylesheet" href="../../css/framework.css">
<link rel="stylesheet" href="../../css/responsive.css"></head>
<body class="ipsApp ipsApp_front ipsJS_has ipsClearfix ipsApp_noTouch" data-controller="core.front.core.app" data-message="" data-pageapp="forums" data-pagelocation="front" data-pagemodule="forums" data-pagecontroller="topic" itemscope="" itemtype="http://schema.org/WebSite">
<main role="main" id="ipsLayout_body" class="ipsLayout_container">
<div id="ipsLayout_contentArea">
<div id="ipsLayout_contentWrapper">
<div id="ipsLayout_mainArea">
<div data-controller="core.front.core.commentFeed,forums.front.topic.view, core.front.core.ignoredComments" data-autopoll="" data-baseurl="" data-lastpage="" data-feedid="topic-787" class="cTopic ipsClear ipsSpacer_top">
<div id="elPostFeed" data-role="commentFeed" data-controller="core.front.core.moderation">
<form action="" method="post" data-ipspageaction="" data-role="moderationTools">
<article id="elComment_109" class="cPost ipsBox  ipsComment  ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone  ">
	

	<div class="cAuthorPane cAuthorPane_mobile ipsResponsive_showPhone ipsResponsive_block">
		<h3 class="ipsType_sectionHead cAuthorPane_author ipsResponsive_showPhone ipsResponsive_inlineBlock ipsType_break ipsType_blendLinks ipsTruncate ipsTruncate_line">
			
Carol Grant
			<span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 1
	
		</span>
	
</span>
		</h3>
		<div class="cAuthorPane_photo">
			

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_10/C.png.09690245bee7e5324c63ccdc3f74c4bf.png" alt="Carol Grant">
	</span>

		</div>
	</div>
	<aside class="ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone"><h3 class="ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break">
<strong>
Carol Grant</strong> <span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 1
	
		</span>
	
</span>
</h3>
		
		<ul class="cAuthorPane_info ipsList_reset">
			
				<li class="ipsType_break">New Member</li>
			
			
				<li><span class="ipsPip"></span></li>
			

			<li class="cAuthorPane_photo">
				

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_10/C.png.09690245bee7e5324c63ccdc3f74c4bf.png" alt="Carol Grant">
	</span>

			</li>
			<li>Members</li>
			
			
				<li>

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 1
	
		</span>
	
</li>
				<li class="ipsType_light">7 posts</li>
				
				

			
		</ul></aside><div class="ipsColumn ipsColumn_fluid">
		

<div id="comment-109_wrap" data-controller="core.front.core.comment" data-commentapp="forums" data-commenttype="forums" data-commentid="109" data-quotedata='{"userid":15913,"username":"Carol Grant","timestamp":1482175670,"contentapp":"forums","contenttype":"forums","contentid":88,"contentclass":"forums_Topic","contentcommentid":109}' class="ipsComment_content ipsType_medium  ipsFaded_withHover">
	

	<div class="ipsComment_meta ipsType_light">
		<div class="ipsPos_right ipsType_light ipsType_reset ipsFaded ipsFaded_more ipsType_blendLinks">
			<ul class="ipsList_inline ipsComment_tools">
				
					<li><a href="https://archive.evisions.com/topic/88-datablock-visual-designer-limit-on-outer-join/?do=reportComment&amp;comment=109" data-ipsdialog data-ipsdialog-remotesubmit data-ipsdialog-size="medium" data-ipsdialog-flashmessage="Thanks for your report." data-ipsdialog-title="Report post" data-action="reportComment" title="Report this content" class="ipsFaded ipsFaded_more"><span class="ipsResponsive_showPhone ipsResponsive_inline"><i class="fa fa-flag"></i></span><span class="ipsResponsive_hidePhone ipsResponsive_inline">Report post</span></a></li>
				
				
				
					<li><a class="ipsType_blendLinks" href="https://archive.evisions.com/topic/88-datablock-visual-designer-limit-on-outer-join/" data-ipstooltip title="Share this post" data-ipsmenu data-ipsmenu-closeonclick="false" id="elSharePost_109" data-role="shareComment"><i class="fa fa-share-alt"></i></a></li>
				
				
			</ul>
		</div>

		<div class="ipsType_reset">
			<a href="https://archive.evisions.com/topic/88-datablock-visual-designer-limit-on-outer-join/?do=findComment&amp;comment=109" class="ipsType_blendLinks">Posted <time datetime="2016-12-19T19:27:50Z" title="12/19/2016 07:27  PM" data-short="2 yr">December 19, 2016</time></a>
			<span class="ipsResponsive_hidePhone">
				
				
			</span>
		</div>
	</div>

	


	<div class="cPost_contentWrap ipsPad">
		
		<div data-role="commentContent" class="ipsType_normal ipsType_richText ipsContained" data-controller="core.front.core.lightboxedImages">
			
<p>
	I am converting our reports from Hyperion/Oracle EPM and I'm wondering how I can put a limit on a table with a left/right outer join and get null values back.  I read through the archive forums and found some help but most are in free type sql.   I primarily use the Visual Designer so I would like an answer using that.   I'm in Advancement and I'm starting to convert our reports.
</p>

<p>
	 
</p>

<p>
	Here's an example:
</p>

<p>
	I would like to see two different address types for Joe Smith but only have it return one row for the person.  I have spraddr with an outer join to spriden and this one would be mailing address where spraddr_atyp_code = 'MA'.  I also want to see people that don't have an 'MA' address type and it would appear blank.  I have spraddr1 which is for my business address if they have one.  If not, I want it blank.  This would also have an outer join to spriden and spraddr1_atyp_code = 'BU'.  It won't return Joe Smith at all if I limit on 'BU' because he doesn't have a Business address. 
</p>

<p>
	 
</p>

<p>
	In visual designer, I have tried many things.  I have tried a calculated field in the WHERE tab that has SPRADDR.SYRADDR_ATYP_CODE (+) = 'MA'.  I've tried adding a group under the WHERE tab so the parentheses would be around it and put  (SPRADDR_ATYP_CODE = 'MA' OR SPRADDR_ATYP_CODE IS NULL) .  What exactly do I need to put in the calculated field for this to work?
</p>

<p>
	 
</p>

<p>
	I know I can do a subquery in my select for the addresses but I'm wondering if that would slow it down?
</p>

<p>
	Another option would be to create a dataset for these once in the report but again I am worried about slowness.
</p>

<p>
	I'm familiar with using ROWID but not an expert. 
</p>

<p>
	 
</p>

<p>
	Thanks for any and all suggestions as we have to rewrite all of our reports <img alt=":(" data-emoticon="" height="20" src="//content.invisioncic.com/r269962/emoticons/sad.png" srcset="//content.invisioncic.com/r269962/emoticons/sad@2x.png 2x" title=":(" width="20"></p>

<p>
	 
</p>

<p>
	Carol Grant
</p>

<p>
	Middlebury College
</p>

<p>
	Middlebury, Vermont
</p>

<p>
	Senior Report Coordinator
</p>

<p>
	 
</p>


			
		</div>

		<div class="ipsItemControls">
			
				
					

	<div data-controller="core.front.core.reaction" class="ipsItemControls_right ipsClearfix ">	
		<div class="ipsReact ipsPos_right">
			
				
				<div class="ipsReact_blurb " data-role="reactionBlurb">
					
						

	
	<ul class="ipsReact_reactions">
	
		
			
			<li class="ipsReact_reactCount">
				
					<span data-ipstooltip title="Like">
				
						<span>
							<img src="//content.invisioncic.com/r269962/reactions/react_like.png" alt="Like">
						</span>
						<span>
							1
						</span>
				
					</span>
				
			</li>
		
	
	</ul>

<div class="ipsReact_overview ipsType_blendLinks">
	
	
</div>
					
				</div>
			
			
			
		</div>
	</div>

				
			
			<ul class="ipsComment_controls ipsClearfix ipsItemControls_left" data-role="commentControls">
				
					
					
					
				
				<li class="ipsHide" data-role="commentLoading">
					<span class="ipsLoading ipsLoading_tiny ipsLoading_noAnim"></span>
				</li>
			</ul>
		</div>

		
	</div>

	<div class="ipsMenu ipsMenu_wide ipsHide cPostShareMenu" id="elSharePost_109_menu">
		<div class="ipsPad">
			<h4 class="ipsType_sectionHead">Share this post</h4>
			<hr class="ipsHr">
			<h5 class="ipsType_normal ipsType_reset">Link to post</h5>
			
			<input type="text" value="https://archive.evisions.com/topic/88-datablock-visual-designer-limit-on-outer-join/" class="ipsField_fullWidth">
			

			
		</div>
	</div>
</div>
	</div>
</article><article id="elComment_226" class="cPost ipsBox  ipsComment  ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone  ">
	

	<div class="cAuthorPane cAuthorPane_mobile ipsResponsive_showPhone ipsResponsive_block">
		<h3 class="ipsType_sectionHead cAuthorPane_author ipsResponsive_showPhone ipsResponsive_inlineBlock ipsType_break ipsType_blendLinks ipsTruncate ipsTruncate_line">
			
Todd Hay
			<span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 16
	
		</span>
	
</span>
		</h3>
		<div class="cAuthorPane_photo">
			

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_01/grumpycat2.thumb.jpg.3b9d127d0f3685ca4a975f30e517a9ba.jpg" alt="Todd Hay">
	</span>

		</div>
	</div>
	<aside class="ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone"><h3 class="ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break">
<strong>
Todd Hay</strong> <span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 16
	
		</span>
	
</span>
</h3>
		
		<ul class="cAuthorPane_info ipsList_reset">
			
				<li class="ipsType_break">Advanced Member</li>
			
			
				<li><span class="ipsPip"></span><span class="ipsPip"></span><span class="ipsPip"></span></li>
			

			<li class="cAuthorPane_photo">
				

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2017_01/grumpycat2.thumb.jpg.3b9d127d0f3685ca4a975f30e517a9ba.jpg" alt="Todd Hay">
	</span>

			</li>
			<li>Members</li>
			
			
				<li>

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_positive">
	
			<i class="fa fa-plus-circle"></i> 16
	
		</span>
	
</li>
				<li class="ipsType_light">53 posts</li>
				
				

			
		</ul></aside><div class="ipsColumn ipsColumn_fluid">
		

<div id="comment-226_wrap" data-controller="core.front.core.comment" data-commentapp="forums" data-commenttype="forums" data-commentid="226" data-quotedata='{"userid":1146,"username":"Todd Hay","timestamp":1486502730,"contentapp":"forums","contenttype":"forums","contentid":88,"contentclass":"forums_Topic","contentcommentid":226}' class="ipsComment_content ipsType_medium  ipsFaded_withHover">
	

	<div class="ipsComment_meta ipsType_light">
		<div class="ipsPos_right ipsType_light ipsType_reset ipsFaded ipsFaded_more ipsType_blendLinks">
			<ul class="ipsList_inline ipsComment_tools">
				
					<li><a href="https://archive.evisions.com/topic/88-datablock-visual-designer-limit-on-outer-join/?do=reportComment&amp;comment=226" data-ipsdialog data-ipsdialog-remotesubmit data-ipsdialog-size="medium" data-ipsdialog-flashmessage="Thanks for your report." data-ipsdialog-title="Report post" data-action="reportComment" title="Report this content" class="ipsFaded ipsFaded_more"><span class="ipsResponsive_showPhone ipsResponsive_inline"><i class="fa fa-flag"></i></span><span class="ipsResponsive_hidePhone ipsResponsive_inline">Report post</span></a></li>
				
				
				
					<li><a class="ipsType_blendLinks" href="https://archive.evisions.com/topic/88-datablock-visual-designer-limit-on-outer-join/?do=findComment&amp;comment=226" data-ipstooltip title="Share this post" data-ipsmenu data-ipsmenu-closeonclick="false" id="elSharePost_226" data-role="shareComment"><i class="fa fa-share-alt"></i></a></li>
				
				
			</ul>
		</div>

		<div class="ipsType_reset">
			<a href="https://archive.evisions.com/topic/88-datablock-visual-designer-limit-on-outer-join/?do=findComment&amp;comment=226" class="ipsType_blendLinks">Posted <time datetime="2017-02-07T21:25:30Z" title="02/07/2017 09:25  PM" data-short="2 yr">February 7, 2017</time></a>
			<span class="ipsResponsive_hidePhone">
				
				
			</span>
		</div>
	</div>

	


	<div class="cPost_contentWrap ipsPad">
		
		<div data-role="commentContent" class="ipsType_normal ipsType_richText ipsContained" data-controller="core.front.core.lightboxedImages">
			
<p>
	Free-Type SQL is probably the best solution.  It gives you more options as your queries get more complex.  The Visual Designer allows subqueries only in the WHERE clause and SELECT clause.  In the example you described, it sounds like you'd want a subquery in your FROM clause (a.k.a inline view) to simplify things.  The Visual Designer will not let you create that kind of subquery.
</p>

<p>
	 
</p>

<p>
	If you *REALLY* want to stay in the Visual Designer then you have two options that I know of.  First, as you mentioned, is to use subqueries in the SELECT clause to gather the address fields you want.  It's probably not super-efficient in terms of optimizier cost but it worked for me; 2200 records presented in a banded report in less than 3 seconds.
</p>

<p>
	 
</p>

<p>
	Below is a link to an example datablock and banded report using this subquery method.  It expects an Oracle database connection and users will need SELECT privileges to SPRIDEN and SPRADDR.  Change the connection to one of your own Oracle databases; preferably a test or pre-production instance if you plan to experiment further.
</p>

<p>
	 
</p>
<iframe data-embedcontent="" frameborder="0" src="https://archive.evisions.com/files/file/1184-stay_in_visual_designer_multi_outer_joins/?do=embed"></iframe>

<p>
	 
</p>

<p>
	We are on the following versions:<br>
	Argos Client Version 5.2.1 Build 1593<br>
	Argos Mapplet Version 5.2.1.1155<br>
	MAP Server Version 5.2.2.1436
</p>

<p>
	 
</p>

<p>
	The other option, which I don't recommend, is to use a UNION operation in the Visual Designer then use some smoke-and-mirror functions and a grouping band in a banded report to merge the BU and MA rows back into one "record".  The UNION operation is fairly quick but there are several Argos expressions that execute so it's probably not very efficient.  I have a working example but it's a dubious option at best.
</p>

<p>
	 
</p>

<p>
	Good Luck,
</p>

<p>
	 
</p>

<p>
	Todd Hay<br>
	Worcester Polytechnic Institute | ITS
</p>


			
		</div>

		<div class="ipsItemControls">
			
				
					

	<div data-controller="core.front.core.reaction" class="ipsItemControls_right ipsClearfix ">	
		<div class="ipsReact ipsPos_right">
			
				
				<div class="ipsReact_blurb " data-role="reactionBlurb">
					
						

	
	<ul class="ipsReact_reactions">
	
		
			
			<li class="ipsReact_reactCount">
				
					<span data-ipstooltip title="Like">
				
						<span>
							<img src="//content.invisioncic.com/r269962/reactions/react_like.png" alt="Like">
						</span>
						<span>
							1
						</span>
				
					</span>
				
			</li>
		
	
	</ul>

<div class="ipsReact_overview ipsType_blendLinks">
	
	
</div>
					
				</div>
			
			
			
		</div>
	</div>

				
			
			<ul class="ipsComment_controls ipsClearfix ipsItemControls_left" data-role="commentControls">
				
					
					
					
				
				<li class="ipsHide" data-role="commentLoading">
					<span class="ipsLoading ipsLoading_tiny ipsLoading_noAnim"></span>
				</li>
			</ul>
		</div>

		
	</div>

	<div class="ipsMenu ipsMenu_wide ipsHide cPostShareMenu" id="elSharePost_226_menu">
		<div class="ipsPad">
			<h4 class="ipsType_sectionHead">Share this post</h4>
			<hr class="ipsHr">
			<h5 class="ipsType_normal ipsType_reset">Link to post</h5>
			
			<input type="text" value="https://archive.evisions.com/topic/88-datablock-visual-designer-limit-on-outer-join/?do=findComment&amp;comment=226" class="ipsField_fullWidth">
			

			
		</div>
	</div>
</div>
	</div>
</article>
</form></div></div></div></div></div></main></body></html>
