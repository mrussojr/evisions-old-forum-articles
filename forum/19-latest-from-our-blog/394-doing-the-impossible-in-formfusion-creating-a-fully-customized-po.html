<html><head>
<link rel="stylesheet" href="../../css/core.css">
<link rel="stylesheet" href="../../css/core_responsive.css">
<link rel="stylesheet" href="../../css/custom.css">
<link rel="stylesheet" href="../../css/flags.css">
<link rel="stylesheet" href="../../css/forums.css">
<link rel="stylesheet" href="../../css/forums_responsive.css">
<link rel="stylesheet" href="../../css/framework.css">
<link rel="stylesheet" href="../../css/responsive.css"></head>
<body class="ipsApp ipsApp_front ipsJS_has ipsClearfix ipsApp_noTouch" data-controller="core.front.core.app" data-message="" data-pageapp="forums" data-pagelocation="front" data-pagemodule="forums" data-pagecontroller="topic" itemscope="" itemtype="http://schema.org/WebSite">
<main role="main" id="ipsLayout_body" class="ipsLayout_container">
<div id="ipsLayout_contentArea">
<div id="ipsLayout_contentWrapper">
<div id="ipsLayout_mainArea">
<div data-controller="core.front.core.commentFeed,forums.front.topic.view, core.front.core.ignoredComments" data-autopoll="" data-baseurl="" data-lastpage="" data-feedid="topic-787" class="cTopic ipsClear ipsSpacer_top">
<div id="elPostFeed" data-role="commentFeed" data-controller="core.front.core.moderation">
<form action="" method="post" data-ipspageaction="" data-role="moderationTools">
<article data-membergroup="4" id="elComment_835" class="cPost ipsBox  ipsComment  ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone ipsComment_highlighted ">
	

	<div class="cAuthorPane cAuthorPane_mobile ipsResponsive_showPhone ipsResponsive_block">
		<h3 class="ipsType_sectionHead cAuthorPane_author ipsResponsive_showPhone ipsResponsive_inlineBlock ipsType_break ipsType_blendLinks ipsTruncate ipsTruncate_line">
			
<span style="color:#ff0000">Evisions</span>
			<span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</span>
		</h3>
		<div class="cAuthorPane_photo">
			

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2016_06/evisions-avatar-400x400.thumb.png.aa430105692c2e4d3be5e6db0c5bdfd8.png" alt="Evisions">
	</span>

		</div>
	</div>
	<aside class="ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone"><h3 class="ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break">
<strong>
Evisions</strong> <span class="ipsResponsive_showPhone ipsResponsive_inline">  

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</span>
</h3>
		
		<ul class="cAuthorPane_info ipsList_reset">
			
				<li class="ipsType_break">Advanced Member</li>
			
			
				<li><span class="ipsPip"></span><span class="ipsPip"></span><span class="ipsPip"></span></li>
			

			<li class="cAuthorPane_photo">
				

	<span class="ipsUserPhoto ipsUserPhoto_large ">
		<img src="//content.invisioncic.com/r269962/monthly_2016_06/evisions-avatar-400x400.thumb.png.aa430105692c2e4d3be5e6db0c5bdfd8.png" alt="Evisions">
	</span>

			</li>
			<li><span style="color:#ff0000">Administrators</span></li>
			
			
				<li>

	
		<span title="Member's total reputation" data-ipstooltip class="ipsRepBadge ipsRepBadge_neutral">
	
			<i class="fa fa-circle"></i> 0
	
		</span>
	
</li>
				<li class="ipsType_light">872 posts</li>
				
				

			
		</ul></aside><div class="ipsColumn ipsColumn_fluid">
		

<div id="comment-835_wrap" data-controller="core.front.core.comment" data-commentapp="forums" data-commenttype="forums" data-commentid="835" data-quotedata='{"userid":1,"username":"Evisions","timestamp":1479225535,"contentapp":"forums","contenttype":"forums","contentid":394,"contentclass":"forums_Topic","contentcommentid":835}' class="ipsComment_content ipsType_medium  ipsFaded_withHover">
	

	<div class="ipsComment_meta ipsType_light">
		<div class="ipsPos_right ipsType_light ipsType_reset ipsFaded ipsFaded_more ipsType_blendLinks">
			<ul class="ipsList_inline ipsComment_tools">
				
					<li><a href="https://archive.evisions.com/topic/394-doing-the-impossible-in-formfusion-creating-a-fully-customized-po/?do=reportComment&amp;comment=835" data-ipsdialog data-ipsdialog-remotesubmit data-ipsdialog-size="medium" data-ipsdialog-flashmessage="Thanks for your report." data-ipsdialog-title="Report post" data-action="reportComment" title="Report this content" class="ipsFaded ipsFaded_more"><span class="ipsResponsive_showPhone ipsResponsive_inline"><i class="fa fa-flag"></i></span><span class="ipsResponsive_hidePhone ipsResponsive_inline">Report post</span></a></li>
				
				
				
					<li><a class="ipsType_blendLinks" href="https://archive.evisions.com/topic/394-doing-the-impossible-in-formfusion-creating-a-fully-customized-po/" data-ipstooltip title="Share this post" data-ipsmenu data-ipsmenu-closeonclick="false" id="elSharePost_835" data-role="shareComment"><i class="fa fa-share-alt"></i></a></li>
				
				
			</ul>
		</div>

		<div class="ipsType_reset">
			<a href="https://archive.evisions.com/topic/394-doing-the-impossible-in-formfusion-creating-a-fully-customized-po/?do=findComment&amp;comment=835" class="ipsType_blendLinks">Posted <time datetime="2016-11-15T15:58:55Z" title="11/15/2016 03:58  PM" data-short="2 yr">November 15, 2016</time></a>
			<span class="ipsResponsive_hidePhone">
				
				
			</span>
		</div>
	</div>

	


	<div class="cPost_contentWrap ipsPad">
		
		<div data-role="commentContent" class="ipsType_normal ipsType_richText ipsContained" data-controller="core.front.core.lightboxedImages">
			
<p>Template designers know that Evisions FormFusion provides flexibility in the look and layout of documents. However, due to the variable nature of some Banner output (i.e. transcripts and purchase orders), versatility of data mapping and control is limited.</p>
<h4><strong>The Project</strong></h4>
<p>I was recently tasked with the challenge of creating a fully customized purchase order (PO) template. The customer wanted to reduce spacing in order to fit the maximum number of items on one page. They wanted to avoid creating multiple page POs, unless necessary. Users would be able to process POs within Banner and use the distribution features of FormFusion, but could produce output to fit their specific needs.</p>
<p>Diving in head first, I knew I was attempting to push the boundaries of how FormFusion is designed to work. (One page of FormFusion processing and output per one page of Banner output.) Development put my critical thinking skills on overdrive, but in the end, the customer received the professional, compact PO template they wanted.</p>
<h4><strong>The Design Concept</strong></h4>
<p>The overall concept of the design consists of building the data, not mapping it. Although some of the basic PO data can be obtained from MapForm, the only MapForm variables I ended up referencing were the PO number and page number. All other variables were created and defined in CaptureForm using those two values.</p>
<h5><strong>Start with the Basics</strong></h5>
<p>The first task in building the PO requires gathering some basic information:</p>
<ul>
<li>Lines per Page – the number of lines for one page of output</li>
<li>Max Items – the max number of items allowed for a purchase order</li>
<li>Max Pages – the max number of pages that the template will output</li>
</ul>
<p><em>The three static values above need to be determined before query development begins.</em></p>
<p>Lines per Page is based solely on the layout of the PO, while the Max Items value must be established and agreed upon by the Finance Department, to include in data entry training.</p>
<p>There is no limit for the Max Items or Max Pages value, because once the logic is figured out and the code written, it’s simply a matter of copying and pasting code to account for larger numbers. If/when there are more items entered in the system than accounted for in the template, the queries are written to only pull the items up to the Max Items value.</p>
<ul>
<li>Total Item Count – the number of items included in the PO</li>
<li>Total Line Count – the number of lines of item detail for the entire PO</li>
<li>Line Count per Item – the number of lines of item detail for each PO item</li>
</ul>
<p><em>The values above are PO specific and are pulled based on the PO number.</em></p>
<p>After the basic data is retrieved, the Items per Page values can be calculated. This query is the backbone of the design and determines which items will print on each page. It involves the most complex logic and, truth-be-told, involved the most coffee, chocolate and code-refactoring for me.</p>
<h5><strong>Capturing the Data</strong></h5>
<p>The next task was to pull the meat of the PO: the item information. The baseline FormFusion template maps the item data in columns (Item No, Quantity, UOM, Description, Unit Price and Total Price). Here, I used the same column formatting, but built the columns in CaptureForm.</p>
<p>The problem child in this task is the item description, as it’s the only data that can extend to multiple lines. The description is stored in three different tables in Banner (requiring union statements and multiple rows returned), so each item description is pulled using individual queries and variables.</p>
<p>Once the description data is retrieved, the columns for the item data can be built using one query per output page. The result should be variables for each column and each page.</p>
<p>Lastly, there are two important parts of this query that need to be coded correctly to ensure proper formatting:</p>
<ul>
<li>Only include the number of items determined to fit on each particular page</li>
<li>Concatenate line feed characters to the single line data (quantity, unit price, etc.) to match the number of lines for each item description</li>
</ul>
<h5><strong>Manipulating the Output</strong></h5>
<p>The final task focuses on getting only the pages needed for output, instead of what FormFusion thinks is needed. As stated earlier, FormFusion will process one page of output for each page in the Banner file. How do you trick it into printing only the pages needed? Well, that logic took a while to think through, but the code and implementation ended up being simple.</p>
<p>The solution combines the page number from MapForm and the Items per Page values created in CaptureForm. In a nutshell, the logic is:</p>
<p style="text-align: center;">“If the item count for the page is not null, then print.”</p>
<p>One overall print variable is used for conditional printing in FormDirector for all Copy/Director combinations and in FormStamp in the form properties.</p>
<p>Although your template will be designed to print multiple pages of output, all with different data, there’s no need to create multiple copies of each FormStamp. All of the data fields can be placed on a single form, overlaying each other, and set to print conditionally depending on which page is being processed.</p>
<p>Similar logic can be used to create print variables for the following data:</p>
<ul>
<li>Page numbers – If there is more than one page, page numbers will print on all pages</li>
<li>PO totals – The totals will print on the last page of output only</li>
<li>Continued label – ‘Continued’ will print in place of PO totals on all but the last page of output</li>
</ul>
<h4><strong>Abracadabra!</strong></h4>
<p>Now you know how the magic happened and how the impossible can be achieved! There were times during this project I thought the possibility of successfully creating this custom purchase order template was unattainable. Luckily for me and the customer, and now for you, I am one determined and over-caffeinated developer.</p>
<p><em>(If you’d like a closer look at the coding &amp; technical side of creating a custom PO, please contact me and I’d be happy to share the details.)</em></p>
<p>The post <a rel="external" href="https://evisions.com/the-impossible-in-formfusion-customized-po/">Doing the Impossible in FormFusion: Creating a Fully Customized PO</a> appeared first on <a rel="external" href="https://evisions.com">Evisions</a>.</p>
<p><a href="https://evisions.com/the-impossible-in-formfusion-customized-po/" rel="external">View the full article</a></p>


			
		</div>

		<div class="ipsItemControls">
			
				
					

	<div data-controller="core.front.core.reaction" class="ipsItemControls_right ipsClearfix ">	
		<div class="ipsReact ipsPos_right">
			
				
				<div class="ipsReact_blurb ipsHide" data-role="reactionBlurb">
					
				</div>
			
			
			
		</div>
	</div>

				
			
			<ul class="ipsComment_controls ipsClearfix ipsItemControls_left" data-role="commentControls">
				
					
					
					
				
				<li class="ipsHide" data-role="commentLoading">
					<span class="ipsLoading ipsLoading_tiny ipsLoading_noAnim"></span>
				</li>
			</ul>
		</div>

		
	</div>

	<div class="ipsMenu ipsMenu_wide ipsHide cPostShareMenu" id="elSharePost_835_menu">
		<div class="ipsPad">
			<h4 class="ipsType_sectionHead">Share this post</h4>
			<hr class="ipsHr">
			<h5 class="ipsType_normal ipsType_reset">Link to post</h5>
			
			<input type="text" value="https://archive.evisions.com/topic/394-doing-the-impossible-in-formfusion-creating-a-fully-customized-po/" class="ipsField_fullWidth">
			

			
		</div>
	</div>
</div>
	</div>
</article>
</form></div></div></div></div></div></main></body></html>
